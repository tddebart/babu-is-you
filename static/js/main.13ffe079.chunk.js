(this["webpackJsonpbabu-is-you"]=this["webpackJsonpbabu-is-you"]||[]).push([[0],{15:function(e,t,i){},16:function(e,t,i){},17:function(e,t,i){},19:function(e,t,i){},20:function(e,t,i){"use strict";i.r(t);var n=i(4),s=i.n(n),r=i(9),a=i.n(r),o=(i(15),i(16),i(1)),d=i(2),c=i(3),h=i(6),u=i(5),l=(i(17),i(0)),g=function(){function e(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(d.a)(this,e),this.canvas=void 0,this.ctx=void 0,this.currentFrame=1,this.isAutoDrawn=void 0,this.canvas=t,this.isAutoDrawn=i,this.canvas.drawings.push(this),this.ctx=t.ctx}return Object(c.a)(e,[{key:"draw",value:function(){}},{key:"remove",value:function(){this.canvas.drawings.slice(this.canvas.drawings.indexOf(this),1)}}]),e}(),v=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e){var n;return Object(d.a)(this,i),(n=t.call(this,e)).drawings=[],n.canvas=void 0,n.ctx=void 0,n.lastFrameTime=void 0,n.FRAMES_PER_SECOND=60,n.FRAME_MIN_TIME=void 0,n.frameTime=0,n.state={},n.FRAME_MIN_TIME=1e3/60*(60/n.FRAMES_PER_SECOND)-1e3/60*.5,n}return Object(c.a)(i,[{key:"componentDidMount",value:function(){this.canvas=document.getElementById("canvas"),this.rescaleCanvas(),this.ctx=this.canvas.getContext("2d"),window.addEventListener("resize",this.rescaleCanvas),window.requestAnimationFrame(this.draw.bind(this))}},{key:"draw",value:function(e){if(e-this.lastFrameTime<this.FRAME_MIN_TIME)window.requestAnimationFrame(this.draw.bind(this));else{this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.lastFrameTime=e,this.frameTime+=1/this.FRAMES_PER_SECOND;var t=!1;this.frameTime%1>.225&&(this.frameTime=0,t=!0);var i,n=Object(o.a)(this.drawings);try{for(n.s();!(i=n.n()).done;){var s=i.value;s.isAutoDrawn&&s.draw(),t&&(3!==s.currentFrame?s.currentFrame++:s.currentFrame=1)}}catch(r){n.e(r)}finally{n.f()}window.requestAnimationFrame(this.draw.bind(this))}}},{key:"rescaleCanvas",value:function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}},{key:"render",value:function(){return Object(l.jsx)("canvas",{id:"canvas"})}}]),i}(n.Component),f=i(7),b=function(){function e(t,i){Object(d.a)(this,e),this.x=void 0,this.y=void 0,this._nodes=[],this.x=t,this.y=i}return Object(c.a)(e,[{key:"nodes",get:function(){return this._nodes.sort((function(e,t){return e.zIndex>t.zIndex?1:e.zIndex<t.zIndex?-1:0}))},set:function(e){this._nodes=e}}]),e}(),m=function(){function e(t,i,n){var s,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Object(d.a)(this,e),this.x=void 0,this.y=void 0,this.text=void 0,this.isPlayer=!1,this._isPushable=!1,this._objectName=void 0,this.rules=[],this._lastDirection=1,this.aniImg=void 0,this.isMoving=!1,this.canvas=void 0,this.grid=void 0,this.xP=0,this.yP=0,this.x=t,this.y=i,this.text=r,this._objectName=a,this.canvas=S.canvas,this.grid=n,-1!==Object.keys(e.Objects).indexOf(a)&&(1===o&&""===a||!e.Objects[a].hasDirs?this._lastDirection=o:this._lastDirection=2),s=""===a?"text_"+r:a,this.aniImg=new E(t,i,n,s,this)}return Object(c.a)(e,[{key:"objectName",get:function(){return this._objectName},set:function(e){this._objectName=e,this.aniImg=""!==e?new E(this.x,this.y,this.grid,e,this):null}},{key:"isText",get:function(){return""!==this.text}},{key:"zIndex",get:function(){return""!==this._objectName?e.Objects[this._objectName].zIndex:-1!==Object.keys(e.Objects).indexOf("text_"+this.text)?e.Objects["text_"+this.text].zIndex:0}},{key:"isPushable",get:function(){return!!this.isText||this._isPushable},set:function(e){this._isPushable=e}},{key:"isText_Object",get:function(){return!!this.isText&&0===e.Objects["text_"+this.text].type}},{key:"isText_Verb",get:function(){return!!this.isText&&1===e.Objects["text_"+this.text].type}},{key:"isText_Quality",get:function(){return!!this.isText&&2===e.Objects["text_"+this.text].type}},{key:"isText_Special",get:function(){return!!this.isText&&6===e.Objects["text_"+this.text].type}},{key:"is",value:function(e){return-1!==this.rules.indexOf(e)}},{key:"lastDirection",value:function(){return 0===this.xP&&-1===this.yP?(this._lastDirection=0,0):1===this.xP&&0===this.yP?(this._lastDirection=1,1):0===this.xP&&1===this.yP?(this._lastDirection=2,2):-1===this.xP&&0===this.yP?(this._lastDirection=3,3):this._lastDirection}},{key:"directionToXAndY",value:function(e){return 0===e?{xP:0,yP:-1}:1===e?{xP:1,yP:0}:2===e?{xP:0,yP:1}:3===e?{xP:-1,yP:0}:{xP:0,yP:0}}}]),e}();m.Objects={};var y=function(){function e(t){Object(d.a)(this,e),this.grid=void 0,this.rules=[],this.grid=t}return Object(c.a)(e,[{key:"updateRules",value:function(){this.rules=[];var e=this.grid.grid,t=document.getElementById("rules-text");null!=t&&(t.innerText="");for(var i=0;i<this.grid.height;i++)for(var n=0;n<this.grid.width;n++)for(var s=0;s<e[i][n].nodes.length;s++){var r=e[i][n].nodes[s];if(r.isText_Object){if(n+1<this.grid.width&&n+2<this.grid.width){var a,d=Object(o.a)(e[i][n+1].nodes);try{for(d.s();!(a=d.n()).done;){var c=a.value;if(c.isText_Verb&&"is"===c.text){for(var h=[],u=!1,l=2;!u;){if(n-l>0&&n-l+1>0){var g,v=Object(o.a)(e[i][n-l].nodes);try{for(v.s();!(g=v.n()).done;){var f=g.value;if(f.isText_Object){var b,y=Object(o.a)(e[i][n-l+1].nodes);try{for(y.s();!(b=y.n()).done;){var x=b.value;x.isText_Special&&"and"===x.text?h.push(f.text):u=!0}}catch(Ae){y.e(Ae)}finally{y.f()}}else u=!0}}catch(Ae){v.e(Ae)}finally{v.f()}}else u=!0;l+=2}h=Array.from(new Set(h));var p,j=Object(o.a)(e[i][n+2].nodes);try{for(j.s();!(p=j.n()).done;){var w=p.value;if(w.isText_Quality||w.isText_Object){var O,k=Object(o.a)(h);try{for(k.s();!(O=k.n()).done;){var I=O.value;this.addRule(I+" "+c.text+" "+w.text)}}catch(Ae){k.e(Ae)}finally{k.f()}this.addRule(r.text+" "+c.text+" "+w.text);for(var M=!1,A=3;!M;){if(n+A<this.grid.width&&n+A+1<this.grid.width){var D,T=Object(o.a)(e[i][n+A].nodes);try{for(T.s();!(D=T.n()).done;){var N=D.value;if(N.isText_Special&&"and"===N.text){var S,P=Object(o.a)(e[i][n+A+1].nodes);try{for(P.s();!(S=P.n()).done;){var E=S.value;if(E.isText_Quality||E.isText_Object){var F,B=Object(o.a)(h);try{for(B.s();!(F=B.n()).done;){var C=F.value;this.addRule(C+" "+c.text+" "+E.text)}}catch(Ae){B.e(Ae)}finally{B.f()}this.addRule(r.text+" "+c.text+" "+E.text)}else M=!0}}catch(Ae){P.e(Ae)}finally{P.f()}}else M=!0}}catch(Ae){T.e(Ae)}finally{T.f()}}else M=!0;A+=2}}}}catch(Ae){j.e(Ae)}finally{j.f()}}}}catch(Ae){d.e(Ae)}finally{d.f()}}if(i+1<this.grid.height&&i+2<this.grid.height){var _,R=Object(o.a)(e[i+1][n].nodes);try{for(R.s();!(_=R.n()).done;){var G=_.value;if(G.isText_Verb&&"is"===G.text){for(var L=[],z=!1,W=2;!z;){if(i-W>0&&i-W+1>0){var Y,J=Object(o.a)(e[i-W][n].nodes);try{for(J.s();!(Y=J.n()).done;){var Q=Y.value;if(Q.isText_Object){var U,Z=Object(o.a)(e[i-W+1][n].nodes);try{for(Z.s();!(U=Z.n()).done;){var H=U.value;H.isText_Special&&"and"===H.text?L.push(Q.text):z=!0}}catch(Ae){Z.e(Ae)}finally{Z.f()}}else z=!0}}catch(Ae){J.e(Ae)}finally{J.f()}}else z=!0;W+=2}L=Array.from(new Set(L));var X,V=Object(o.a)(e[i+2][n].nodes);try{for(V.s();!(X=V.n()).done;){var q=X.value;if(q.isText_Quality||q.isText_Object){var K,$=Object(o.a)(L);try{for($.s();!(K=$.n()).done;){var ee=K.value;this.addRule(ee+" "+G.text+" "+q.text)}}catch(Ae){$.e(Ae)}finally{$.f()}this.addRule(r.text+" "+G.text+" "+q.text);for(var te=!1,ie=3;!te;){if(i+ie<this.grid.height&&i+ie+1<this.grid.height){var ne,se=Object(o.a)(e[i+ie][n].nodes);try{for(se.s();!(ne=se.n()).done;){var re=ne.value;if(re.isText_Special&&"and"===re.text){var ae,oe=Object(o.a)(e[i+ie+1][n].nodes);try{for(oe.s();!(ae=oe.n()).done;){var de=ae.value;if(de.isText_Quality||de.isText_Object){var ce,he=Object(o.a)(L);try{for(he.s();!(ce=he.n()).done;){var ue=ce.value;this.addRule(ue+" "+G.text+" "+de.text)}}catch(Ae){he.e(Ae)}finally{he.f()}this.addRule(r.text+" "+G.text+" "+de.text)}else te=!0}}catch(Ae){oe.e(Ae)}finally{oe.f()}}else te=!0}}catch(Ae){se.e(Ae)}finally{se.f()}}else te=!0;ie+=2}}}}catch(Ae){V.e(Ae)}finally{V.f()}}}}catch(Ae){R.e(Ae)}finally{R.f()}}}}this.rules=Array.from(new Set(this.rules)),this.resetAllNodeRules();var le,ge=Object(o.a)(this.rules);try{for(ge.s();!(le=ge.n()).done;){for(var ve=le.value,fe=ve.split(" "),be=fe[0],me=fe[1],ye=fe[2],xe=[],pe=0;pe<this.grid.height;pe++)for(var je=0;je<this.grid.width;je++)for(var we=0;we<this.grid.grid[pe][je].nodes.length;we++){var Oe=this.grid.grid[pe][je].nodes[we];Oe.objectName===be&&"is"===me&&xe.push(Oe)}for(var ke=0,Ie=xe;ke<Ie.length;ke++){var Me=Ie[ke];switch(-1!==Object.keys(m.Objects).indexOf(ye)&&(this.grid.undoActions.push({node:Me,changeTo:Me.objectName,changeOn:this.grid.undoStep+1}),this.grid.doAfterMove.push({node:Me,newObjectName:ye})),ye){case"you":Me.isPlayer=!0,this.grid.playerPositions.push({x:Me.x,y:Me.y,skip:!1});break;case"push":Me.isPushable=!0;break;default:Me.rules.push(ye)}}null!=t&&(t.innerText+=ve+"\n")}}catch(Ae){ge.e(Ae)}finally{ge.f()}}},{key:"resetAllNodeRules",value:function(){this.grid.playerPositions=[];for(var e=this.grid.grid,t=0;t<this.grid.height;t++)for(var i=0;i<this.grid.width;i++)for(var n=0;n<e[t][i].nodes.length;n++){var s=e[t][i].nodes[n];s.isPlayer=!1,s.isPushable=!1,s.rules=[]}}},{key:"addRule",value:function(e){this.rules.push(e)}}]),e}();var x=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e,n,s,r){var a,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return Object(d.a)(this,i),(a=t.call(this,e)).width=void 0,a.height=void 0,a.resolution=void 0,a.grid=[],a.offset=void 0,a.playerPositions=[],a.gridImage=void 0,a.undoMoves=[],a.undoActions=[],a.doAfterMove=[],a.undoStep=0,a.rules=new y(Object(f.a)(a)),a.didMoveThisStep=!1,a.debug=void 0,a.width=n,a.height=s,a.resolution=r,a.debug=o,a.updateGrid(n,s),a.rules.updateRules(),a.canvas.canvas.addEventListener("click",a.calculateText.bind(Object(f.a)(a))),a}return Object(c.a)(i,[{key:"updateGrid",value:function(e,t){this.debug=!1,this.grid=[],this.undoStep=0,this.undoMoves=[],this.undoActions=[],this.width=e,this.height=t,this.updateScreenScalings(),this.gridImage=this.drawGrid(),this.initializeGrid(e,t)}},{key:"updateScreenScalings",value:function(){var e,t,i,n,s;!function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series([46])0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br([ev])w|bumb|bw-([nu])|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do([cp])o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly([-_])|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \-/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja([tv])a|jbro|jemu|jigs|kddi|keji|kgt([ /])|klon|kpt |kwc-|kyo([ck])|le(no|xi)|lg( g|\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30([02])|n50([025])|n7(0([01])|10)|ne(([cm])-|on|tf|wf|wg|wt)|nok([6i])|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c([-01])|47|mc|nd|ri)|sgh-|shar|sie([-m])|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel([im])|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c([- ])|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4)))&&(t=!0),t}()?(e=(window.innerWidth-100)/this.width,t=(window.innerHeight-100)/this.height):(e=(window.innerWidth-10)/this.width,t=(window.innerHeight-10)/this.height),this.resolution=(i=Math.round(Math.min(e,t)),n=5,s=150,Math.min(Math.max(i,n),s)),this.offset={x:Math.floor(window.innerWidth/2-this.width/2*this.resolution),y:Math.floor(window.innerHeight/2-this.height/2*this.resolution)},this.gridImage=this.drawGrid();var r=document.getElementById("background");r&&("false"===localStorage.getItem("grid")?(r.style.display="block",r.style.left=this.offset.x.toString()+"px",r.style.top=this.offset.y.toString()+"px",r.style.width=this.width*this.resolution+"px",r.style.height=this.height*this.resolution+"px"):r.style.display="none")}},{key:"initializeGrid",value:function(e,t){for(var i=this,n=0;n<t;n++){for(var s=[],r=0;r<e;r++)s.push(new b(r,n));this.grid.push(s)}this.debug&&setTimeout((function(){for(var n=0;n<t;n++)for(var s=0;s<e;s++)5===s&&5===n&&i.grid[n][s].nodes.push(new m(s,n,i,"","babu")),7===s&&5===n&&i.grid[n][s].nodes.push(new m(s,n,i,"","keke")),3===s&&3===n&&i.grid[n][s].nodes.push(new m(s,n,i,"babu")),4===s&&3===n&&i.grid[n][s].nodes.push(new m(s,n,i,"is")),5===s&&3===n&&i.grid[n][s].nodes.push(new m(s,n,i,"you")),6===s&&3===n&&i.grid[n][s].nodes.push(new m(s,n,i,"and")),7===s&&3===n&&i.grid[n][s].nodes.push(new m(s,n,i,"stop"))}),5e3)}},{key:"calculateText",value:function(e){var t=e.clientX-this.offset.x,i=e.clientY-this.offset.y,n={x:Math.floor(t/this.resolution),y:Math.floor(i/this.resolution)};if(!(n.x<0||n.x>=this.width||n.y<0||n.y>=this.height)){var s=prompt("Give a value.");null!==s&&this.grid[n.y][n.x].nodes.push(new m(n.x,n.y,this,s)),this.rules.updateRules()}}},{key:"doMovement",value:function(){for(var e=[],t=0;t<this.height;t++)for(var i=0;i<this.width;i++){var n,s=Object(o.a)(this.grid[t][i].nodes);try{for(s.s();!(n=s.n()).done;){var r=n.value;if(r.is("move")){var a=r.directionToXAndY(r.lastDirection());this.canMoveIntoNode(r,a.xP,a.yP)||(a={xP:-a.xP,yP:-a.yP}),e.push({node:r,xP:a.xP,yP:a.yP})}if(r.is("defeat")&&this.grid[t][i].nodes.some((function(e){return e.isPlayer}))){var d,c=Object(o.a)(this.grid[t][i].nodes.filter((function(e){return e.isPlayer})));try{for(c.s();!(d=c.n()).done;){var h=d.value;this.undoActions.push({node:h,changeTo:h.objectName,changeOn:this.undoStep+1}),h.objectName=""}}catch(y){c.e(y)}finally{c.f()}}if(r.is("win")&&this.grid[t][i].nodes.some((function(e){return e.isPlayer}))&&function(){var e=document.getElementById("loading");e.innerText="CONGRATULATIONS",e.style.display="",e.style.animation="winScreen 4s linear",e.style.animationFillMode="forwards",e.addEventListener("animationend",(function(){e.style.animation="",e.style.display="none"}))}(),r.is("sink")&&this.grid[t][i].nodes.some((function(e){return!e.is("sink")}))){var u=this.grid[t][i].nodes.find((function(e){return!e.is("sink")}));u&&(this.undoActions.push({node:u,changeTo:u.objectName,changeOn:this.undoStep+1}),u.objectName="",this.undoActions.push({node:r,changeTo:r.objectName,changeOn:this.undoStep+1}),r.objectName="")}if(r.is("hot")){var l,g=Object(o.a)(this.grid[t][i].nodes.filter((function(e){return e.is("melt")})));try{for(g.s();!(l=g.n()).done;){var v=l.value;this.undoActions.push({node:v,changeTo:v.objectName,changeOn:this.undoStep+1}),v.objectName=""}}catch(y){g.e(y)}finally{g.f()}}}}catch(y){s.e(y)}finally{s.f()}}for(var f=0,b=e;f<b.length;f++){var m=b[f];this.moveNode(m.node,m.xP,m.yP)}}},{key:"canMoveIntoNode",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.grid,r=e.x,a=e.y;if(r+t<0||r+t>this.width-1||a+i<0||a+i>this.height-1)return!1;for(var o=0;o<s[a+i][r+t].nodes.length;o++){var d=s[a+i][r+t].nodes[o];if(!n&&d.isPushable){if(d.x+t<0||d.x+t>this.width-1||d.y+i<0||d.y+i>this.height-1)return!1;if(0===s[d.y+i][d.x+t].nodes.length)return this.moveNode(d,t,i,!0),!0;for(var c=0;c<s[d.y+i][d.x+t].nodes.length;c++)if(this.canMoveIntoNode(d,t,i))return this.moveNode(d,t,i,!0),!0;return!1}if(d.is("stop"))return!1}return!0}},{key:"moveNode",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!n&&!this.canMoveIntoNode(e,t,i,a))return!1;var o=this.grid[e.y][e.x],d=this.grid[e.y+i][e.x+t];return e.x+=t,e.y+=i,r?(e.xP=-t,e.yP=-i):(e.xP=t,e.yP=i),d.nodes.push(e),o.nodes.splice(o.nodes.indexOf(e),1),s||(this.didMoveThisStep=!0,this.undoMoves.length-1!==this.undoStep&&this.undoMoves.push([]),this.undoMoves[this.undoStep].push({node:d.nodes[d.nodes.findIndex((function(t){return t===e}))],xP:-t,yP:-i,doAction:!1})),!0}},{key:"draw",value:function(){this.ctx.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.ctx.imageSmoothingEnabled=!1,"true"===localStorage.getItem("grid")&&this.ctx.drawImage(this.gridImage,this.offset.x,this.offset.y);for(var e=0;e<25;e++)for(var t=0;t<this.height;t++)for(var i=0;i<this.width;i++)for(var n=0;n<this.grid[t][i].nodes.length;n++){var s=this.grid[t][i].nodes[n];if(""!==s.objectName){if(m.Objects[s.objectName].zIndex!==e)continue;var r=s.aniImg;null!==r&&(r.x=i,r.y=t,r.grid=this,r.lastDirection=s.lastDirection(),r.resolution=this.resolution,r.offset=this.offset,r.draw())}if(s.isText){if(m.Objects["text_"+s.text].zIndex!==e)continue;var a=s.aniImg;null!==a&&(a.x=i,a.y=t,a.grid=this,a.resolution=this.resolution,a.offset=this.offset,a.draw())}}}},{key:"drawGrid",value:function(){var e=this.width,t=this.height,i=this.resolution,n=document.createElement("canvas");n.width=e*i,n.height=t*i;var s=n.getContext("2d");if(s){s.imageSmoothingEnabled=!1,s.globalCompositeOperation="source-over",s.strokeStyle="rgba(0,0,0,1)",s.fillStyle="rgba(0,0,0,1)",s.lineWidth=Math.round(Math.max(this.resolution/40,1)),s.beginPath();for(var r=0;r<e;r++)s.moveTo(r*i,0),s.lineTo(r*i,t*i);s.stroke(),s.beginPath();for(var a=0;a<e;a++)s.moveTo(0,a*i),s.lineTo(e*i,a*i);s.stroke(),s.beginPath(),s.moveTo(e*i,0),s.lineTo(e*i,t*i),s.stroke(),s.beginPath(),s.moveTo(0,t*i),s.lineTo(e*i,t*i),s.stroke()}return n}}]),i}(g);var p=i(10),j=function e(){Object(d.a)(this,e),this.ID=-1,this.Name="",this.Active=void 0,this.x=0,this.y=0,this.Sprite="",this.direction=1,this.Tiling=-1,this.Color=void 0,this.zIndex=13,this.Type=0,this.Active=!0},w={},O={};function k(){console.log("generating defealts"),fetch("/babu-is-you/values.lua").then((function(e){return e.text()})).then((function(e){var t,i=e.split("\n"),n=Object(o.a)(i);try{var s=function(){var e=t.value;0===e.indexOf("tileslist =")&&(!function(e,t){for(var i=0,n=e+1;n<t.length;n++){var s=t[n].trim();if("}"===s)break;var r=s.indexOf("=");if(!(s.length<2||r<0)){var a=new j;0===(s=s.substring(0,r).trim()).indexOf("object")&&parseInt(s.substring(6),10)>i&&(i=parseInt(s.substring(6),10)),a.Name=s;for(var o=n+1;o<t.length;o++){var d=t[o].trim();if("},"===d){n+=o-n;break}if(!((r=d.indexOf("="))<0)){var c=d.substring(r+1,d.length).trim();d=d.substring(0,r).trim().toLowerCase(),c.includes("baba")&&(c=c.replace("baba","babu")),I(a,d,c)}}w[a.ID]=a,O[a.Name]=a}}(function(){for(var e=0,t=Object.keys(O);e<t.length;e++){var i=t[e],n=O[i];-1===Object.keys(m.Objects).indexOf(n.Name)&&(m.Objects[i]={x:n.Color.x,y:n.Color.y,type:n.Type,zIndex:n.zIndex,hasWalkAni:2===n.Tiling,hasDirs:0===n.Tiling,isTileable:1===n.Tiling,spriteName:n.Sprite})}S.hasLoadedObjects=!0})()}(i.findIndex((function(t){return t===e})),i),S.loadGrid(),S.loadAllImages())};for(n.s();!(t=n.n()).done;)s()}catch(r){n.e(r)}finally{n.f()}}))}function I(e,t,i){switch(t){case"name":e.Name=i.substring(1,i.length-2);break;case"sprite":e.Sprite=i.substring(1,i.length-2);break;case"layer":e.zIndex=parseInt(i);break;case"colour":case"active":e.Color=M(i);break;case"tiling":e.Tiling=parseInt(i);break;case"tile":e.ID=function(e){var t=0,i=e.length;0===e.indexOf("{")&&(t++,i--);var n=e.indexOf(",");if(n<0)return parseInt(e);var s=parseInt(e.substring(t,t+(n-t)));return parseInt(e.substring(n+1,n+(i-n-1)))<<8|s}(i);break;case"type":e.Type=parseInt(i)}}function M(e){return{x:parseInt(e.split("")[1]),y:parseInt(e.split("")[4])}}function A(e){if(null!==e&&"string"===typeof e)if("ACHTUNG!"===e.slice(0,8)){for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i).toString(16);n.length<2&&(n="0"+n),t+=" "+n}var s=t.split(" ");s.shift();var r=28,a=T(s.slice(r,r+2));r+=2;for(var o=0;o<a;o++)D(s,r)}else console.error("Invalid map file")}function D(e,t){var i=T(e.slice(t,t+4));t+=4;var n=T(e.slice(t,t+4));t+=4;var s=i*n;t+=32,t+=1,t+=4;var r=T(e.slice(t,t+4));t+=4;for(var a=e.slice(t,t+r),o=new Uint8Array(a.map((function(e){return parseInt(e,16)}))),d=p.a.inflate(o),c=[],h=0;h<d.length;h++){var u=d[h].toString(16);1===u.length&&(u="0"+u),c.push(u.toString())}for(var l=[],g=0,v=0;g<s;g++,v+=2){var f=T([c[v],c[v+1]]);if(f in w){if("edge"===w[f].Name)continue;var b=Object.assign(Object.create(Object.getPrototypeOf(w[f])),w[f]);b.x=g%i,b.y=Math.floor(g/i),l.push(b)}}var y=S.grid;y.updateGrid(i-2,n-2);for(var x=0,j=l;x<j.length;x++){var O=j[x];O.Name.includes("text")?y.grid[O.y-1][O.x-1].nodes.push(new m(O.x-1,O.y-1,y,O.Name.split("_")[1],"",O.direction)):y.grid[O.y-1][O.x-1].nodes.push(new m(O.x-1,O.y-1,y,"",O.Name,O.direction))}y.rules.updateRules()}function T(e){for(var t="",i=e.length-1;i>=0;i--)t+=e[i];return parseInt(t,16)}i(19);var N=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(){var e;Object(d.a)(this,i);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).isInMain=!0,e.isInSettings=!1,e.isInCredits=!1,e}return Object(c.a)(i,[{key:"render",value:function(){var e=this;return this.isInMain?Object(l.jsxs)("div",{className:"mainMenu",children:[Object(l.jsx)("img",{className:"mainImage",id:"mainImage",src:"/babu-is-you/mainMenu/babu-is-you.gif",alt:"babu is you"}),Object(l.jsx)("div",{style:{fontFamily:"arial"},children:"A RECREATION OF THE GAME BABA iS YOU"}),Object(l.jsx)("div",{style:{height:"5%"}}),Object(l.jsx)("img",{id:"start",src:"/babu-is-you/mainMenu/startGame.png",alt:"babu is you",onMouseEnter:function(){document.getElementById("start").src="/babu-is-you/mainMenu/startGameSelected.png"},onMouseOut:function(){document.getElementById("start").src="/babu-is-you/mainMenu/startGame.png"},onClick:function(){e.isInMain=!1,k(),e.forceUpdate()}}),Object(l.jsx)("br",{}),Object(l.jsx)("img",{id:"settings",src:"/babu-is-you/mainMenu/settings.png",alt:"babu is you",onMouseEnter:function(){document.getElementById("settings").src="/babu-is-you/mainMenu/settingsSelected.png"},onMouseOut:function(){document.getElementById("settings").src="/babu-is-you/mainMenu/settings.png"},onClick:function(){e.isInMain=!1,e.isInSettings=!0,e.forceUpdate()}}),Object(l.jsx)("br",{}),Object(l.jsx)("img",{id:"credits",src:"/babu-is-you/mainMenu/credits.png",alt:"babu is you",onMouseEnter:function(){document.getElementById("credits").src="/babu-is-you/mainMenu/creditsSelected.png"},onMouseOut:function(){document.getElementById("credits").src="/babu-is-you/mainMenu/credits.png"},onClick:function(){e.isInMain=!1,e.isInCredits=!0,e.forceUpdate()}})]}):this.isInSettings?Object(l.jsxs)("div",{className:"mainMenu",children:[Object(l.jsx)("h1",{children:"Settings"}),"true"===localStorage.getItem("grid")&&Object(l.jsx)("img",{style:{display:"inline-block"},id:"grid",src:"/babu-is-you/mainMenu/gridOn.png",alt:"grid",onMouseEnter:function(){document.getElementById("grid").src="/babu-is-you/mainMenu/gridOnSelected.png"},onMouseOut:function(){document.getElementById("grid").src="/babu-is-you/mainMenu/gridOn.png"},onClick:function(){localStorage.setItem("grid","true"===localStorage.getItem("grid")?"false":"true"),e.forceUpdate()}}),"false"===localStorage.getItem("grid")&&Object(l.jsx)("img",{style:{display:"inline-block"},id:"grid",src:"/babu-is-you/mainMenu/grid.png",alt:"grid",onMouseEnter:function(){document.getElementById("grid").src="/babu-is-you/mainMenu/gridSelected.png"},onMouseOut:function(){document.getElementById("grid").src="/babu-is-you/mainMenu/grid.png"},onClick:function(){localStorage.setItem("grid","true"===localStorage.getItem("grid")?"false":"true"),e.forceUpdate()}}),Object(l.jsx)("img",{id:"return",src:"/babu-is-you/mainMenu/return.png",alt:"return",onMouseEnter:function(){document.getElementById("return").src="/babu-is-you/mainMenu/returnSelected.png"},onMouseOut:function(){document.getElementById("return").src="/babu-is-you/mainMenu/return.png"},onClick:function(){e.isInSettings=!1,e.isInMain=!0,e.forceUpdate()}})]}):this.isInCredits?Object(l.jsxs)("div",{className:"mainMenu",children:[Object(l.jsx)("h1",{children:"Credits"}),Object(l.jsx)("p",{className:"creditsText",style:{width:"30%",textAlign:"center"},children:"All sprites and level design are not mine and i don't claim they are mine they are from the original creator of baba is you which this game is a recreation of"}),Object(l.jsx)("img",{id:"return",src:"/babu-is-you/mainMenu/return.png",alt:"babu is you",onMouseEnter:function(){document.getElementById("return").src="/babu-is-you/mainMenu/returnSelected.png"},onMouseOut:function(){document.getElementById("return").src="/babu-is-you/mainMenu/return.png"},onClick:function(){e.isInCredits=!1,e.isInMain=!0,e.forceUpdate()}})]}):Object(l.jsx)("div",{className:"mainMenu",style:{display:"none"}})}}]),i}(n.Component),S=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e){var n;return Object(d.a)(this,i),(n=t.call(this,e)).canMove=!0,n.justUndone=!1,n.interval=void 0,n.intervalW=void 0,n.intervalD=void 0,n.intervalS=void 0,n.intervalA=void 0,n.state={percentage:0},n}return Object(c.a)(i,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.keyDetectDown.bind(this),!1),window.addEventListener("keyup",this.keyDetectUp.bind(this),!1),i.debug=!1,null===localStorage.getItem("grid")&&localStorage.setItem("grid","true"),i.debug&&k()}},{key:"movePlayers",value:function(e,t){var n=this;if(this.canMove&&0!==i._grid.playerPositions.length){if(i._grid.undoMoves.length=i._grid.undoStep,i._grid.undoMoves.length>100){i._grid.undoMoves.shift(),i._grid.undoStep--;var s,r=Object(o.a)(i.grid.undoActions);try{for(r.s();!(s=r.n()).done;){s.value.changeOn--}}catch(y){r.e(y)}finally{r.f()}}var a,d=0,c=Object(o.a)(i._grid.playerPositions);try{for(c.s();!(a=c.n()).done;){var h=a.value;if(h.skip)h.skip=!1;else{var u=i._grid.grid[h.y][h.x].nodes.find((function(e){return e.isPlayer}));null!=u&&(i._grid.moveNode(u,e,t)||d++,h.skip=!1)}}}catch(y){c.e(y)}finally{c.f()}i._grid.doMovement(),i._grid.rules.updateRules();var l,g=0,v=Object(o.a)(i._grid.rules.rules);try{for(v.s();!(l=v.n()).done;){"you"!==l.value.split(" ")[2]&&g++}}catch(y){v.e(y)}finally{v.f()}if((d!==i._grid.playerPositions.length||g===i._grid.rules.rules.length||i._grid.didMoveThisStep)&&(i._grid.undoStep++,i._grid.didMoveThisStep=!1),0!==i._grid.doAfterMove.length){var f,b=Object(o.a)(i._grid.doAfterMove);try{for(b.s();!(f=b.n()).done;){var m=f.value;m.node.objectName=m.newObjectName}}catch(y){b.e(y)}finally{b.f()}i._grid.rules.resetAllNodeRules()}i._grid.rules.updateRules(),this.canMove=!1,setTimeout((function(){n.canMove=!0}),100)}}},{key:"undoMoves",value:function(){if(!(i.grid.undoStep-1<0))if(this.canMove=!1,i.grid.undoMoves.length<i.grid.undoStep)console.error("Could not do undo with: "+i.grid.undoMoves+" and "+i.grid.undoStep);else{for(var e=i.grid.undoMoves[i.grid.undoStep-1].slice(),t=e.length-1;t>=0;t--){var n=e[t];i.grid.moveNode(n.node,n.xP,n.yP,!1,!0,!0,!0);var s,r=Object(o.a)(i.grid.undoActions);try{var a=function(){var e=s.value;e.changeOn===i.grid.undoStep&&(e.node.objectName=e.changeTo,i.grid.doAfterMove=[],i.grid.undoActions=i.grid.undoActions.filter((function(t){return t!==e})))};for(r.s();!(s=r.n()).done;)a()}catch(d){r.e(d)}finally{r.f()}}i.grid.rules.updateRules(),i.grid.undoStep--,this.justUndone=!0,this.canMove=!0}}},{key:"keyDetectDown",value:function(e){var t=this;!e.repeat&&i.hasFullyLoaded&&("w"!==e.key&&"ArrowUp"!==e.key||(this.movePlayers(0,-1),this.intervalW=setInterval((function(){return t.movePlayers(0,-1)}),150)),"a"!==e.key&&"ArrowLeft"!==e.key||(this.movePlayers(-1,0),this.intervalA=setInterval((function(){return t.movePlayers(-1,0)}),150)),"s"!==e.key&&"ArrowDown"!==e.key||(this.movePlayers(0,1),this.intervalS=setInterval((function(){return t.movePlayers(0,1)}),150)),"d"!==e.key&&"ArrowRight"!==e.key||(this.movePlayers(1,0),this.intervalD=setInterval((function(){return t.movePlayers(1,0)}),150)),"z"===e.key&&(this.undoMoves(),this.interval=setInterval((function(){return t.undoMoves()}),200)))}},{key:"keyDetectUp",value:function(e){e.repeat||("w"!==e.key&&"ArrowUp"!==e.key||clearInterval(this.intervalW),"a"!==e.key&&"ArrowLeft"!==e.key||clearInterval(this.intervalA),"s"!==e.key&&"ArrowDown"!==e.key||clearInterval(this.intervalS),"d"!==e.key&&"ArrowRight"!==e.key||clearInterval(this.intervalD),"z"===e.key&&clearInterval(this.interval))}},{key:"render",value:function(){return Object(l.jsxs)(l.Fragment,{children:[!i.debug&&Object(l.jsx)(N,{ref:function(e){if(e)return i.mainMenu=e}}),Object(l.jsx)("div",{id:"background",className:"background"}),Object(l.jsx)("div",{id:"loading",className:"loading",children:"LOADING 0%"}),Object(l.jsx)("a",{href:"https://github.com/tddebart/babu-is-you",target:"_blank",rel:"noreferrer",children:Object(l.jsx)("img",{className:"github",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzlFQkFERkU4NkJCMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzlFQkFERkQ4NkJCMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJFOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJGOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Kk5lQwAABYxJREFUeNrkm29oVXUYx3+7bM3V1FnbqlltrtXWtYRa1nqxooY5E7EhKWGuaTDBagol9SIMDCKICASj+cISw/DPi16ZBakrUBnoC7nNoTMWy6I1c+LmVq6t78N9jpyu555znt855+536IHPi939/jzP95zznN+/kzc1NaUitirwJJgPasF94DZQDG7hMqNgBFwEZ5kU+AH0R+lcXgQCJMBT4EXwLKgM2N7P4FvwJegCk6YKUA5eB23grogu2C/gc7AN/GGKABTsZtAOZqjc2DjYAT5kUfSNBNCkAGwGo1PTZ6PsQ4FuHLp3QD3YDR5QZtgZsAac1ElYokcGbATHDApesS/kUwf7GEkOKAK7wAvKbNsPXgZjYQowG3wNnlDxsONgCbgchgAU/GHwiIqXUT5o8hLBKwfcDA7FMHgrUR/iGLQEoGTyBWhQ8bUGjiFPR4A3QIuKv7VwLKIcQMnue5Dv0fjT/IwtAM3g+RyMBmkU+BXf3qc5Rx3xqDPBE7LjfkaCheCcj1HYKYe6JeBt8GcEo75L3HaJQ7+nfNQ/x7H9p67TFX4L1Pi4EocdfhsGH4BPwVbwqu0xGwI/8vT2N/77Gv+vAJSCO3n6PJ//Vjz72w62cPtORnfAwx7+1nBsW93ugGow7vOKtPkYa9eDl0Clxji9kuvW+yjb5tPncY7xet3MhjoFt2RzgIlU2DQL/O6017W/Be4BawXJqMCgTH+ToOxajvWG1+AmYVBlBglQKrxwmzIFoB9XCzt91CABpL6sti62JcBiXtKS2GMGCSD1pZxjvi7AKmED9PraYJAAG2yvVL+2yi7AImHl90C3QQJ03/B+97ZF1lCYVlN6BBV/BffykNQkoyF4H5grqJOkO6BR2NF2A4O35gifCOs0JjTW9vYaPPPbJ11LJAFqBRVoDf68wQLQI3BBUL424XPiY1lvDOb/ZwRla0iAOYIKv8dAgEFB2VtJgJmCChMxEEAyHigmAQoFFWbFQIDZgrKF0p2hmTEQQOQjCTAmKD8vBgJUCcqOkQBXBBXosEORwcEXKdmBjCskwICgQr5h0+BMW6i8V7LtNkAC9As7WWqwAM8Jy/cnhBMhspVKvq2eC0uwbxLrSWhMa+dpdJQLW6mRpLtpOlyuMcL7CTwErhoSPG2ApjQEuD3BQ0fp0ZJqlT6pZYpt0wieYh60nuWDGp2+At4xIPgt7IvU0jHzBkFdgD27HWDGNGyGFHHfulaXuTN0IkBjZ8EykJeDwKmPFtAXwN8TTltjrVkKfwcawXJW3G3v8DTYCKoiCLwGvAl6QthpbnU6J5jP2f1uh1Wgxbbxwv0qvT/vtZRGA6wuzs50+Pkb8JdgQtPMq1VJld7bnxtSzhjgJD5hzwEW611OZK6xlSvzeYbAsl3Cx4PK7ozodOl6t93hfJByqbzOVnYh+MdHhxfBLI1bnuoMhRx8imPMKgDR5LG/nrSVfddHpx8HeO4/ClmApsw+snXsdk7gYMat+r5Hp0sDCLAkxOA7nfrI1nGxx2tmQUb5x8FuzgvD4Dw4wNm2MIAA1SEF38cx+RaAeBCMZGlwb44GOyUhBD/CsTj24TatpddXq3L+RIVmXnE4QzjJMaSylvBxFdqzKHsVrDD8Dmj36sOvIx0unewHDRENg4MI0BH2FyP0RcZOlzW3Ib7VLvPqDK0z1PEq7bDmLVwCLgnr0AhvnUp/0eJp0k9m6HO4fUp2nGZODgUY5PzUJVlHkxg1TEfnjxqY8I6yb12SSjqLm7T9/Ax4TaW/+JxuIx862KcL4toBk1QFT1omXZLRHQHaL3Npl/r8jH3QjiGsbJ3kGd/fDo6WBWi31KG9a9xXMgzfw35tVfCR9l52dk8Ibe7htnq57YowfY7i4+lYWUL9z+1fAQYACqstE4NCc18AAAAASUVORK5CYII=",alt:"github"})}),Object(l.jsx)("button",{style:{position:"absolute",top:"10px"},onClick:function(){return console.log(i._grid)},children:"Grid"}),Object(l.jsx)("input",{type:"file",style:{position:"absolute",left:250,top:"10px"},onChange:function(e){return function(e){var t=e.target.files[0];if(t){var i=new FileReader;i.onload=function(){return A(this.result)},i.readAsBinaryString(t)}}(e)}}),Object(l.jsx)("label",{style:{position:"absolute",left:250,top:25,fontSize:20},children:"Load a world (.l file)"}),Object(l.jsx)("div",{id:"rules-text",style:{position:"absolute",top:"10px",left:"10px",textAlign:"left"}}),Object(l.jsx)(v,{ref:function(e){if(e)return i.canvas=e}})]})}}],[{key:"hasFullyLoaded",get:function(){return!(!i.debug&&!i.fastLoading)||Object.keys(i.drawings).length===Object.keys(m.Objects).length-1}},{key:"grid",get:function(){return this._grid},set:function(e){this._grid=e,window.addEventListener("resize",e.updateScreenScalings.bind(i.grid))}},{key:"loadGrid",value:function(){i._grid=new x(i.canvas,10,10,i.resolution,i.debug),window.addEventListener("resize",i._grid.updateScreenScalings.bind(i._grid))}},{key:"loadAllImages",value:function(){var e=new Image(7,5);e.src="/babu-is-you/img/Palettes/default.png",e.onload=function(){for(var t=function(){var t=s[n];if((i.debug||i.fastLoading)&&!P.some((function(e){return t.includes(e)})))return"continue";var r=[],a=0;m.Objects[t].hasDirs&&(a=24),m.Objects[t].hasWalkAni&&(a=27),m.Objects[t].isTileable&&(a=15);for(var o=0;o<a+1;o++){r[o]=[];for(var d=1;d<4;d++)r[o][d]=void 0}for(var c=function(n){for(var s=function(s){var a=new Image(24,24);t.includes("text")?a.src="/babu-is-you/img/texts/"+m.Objects[t].spriteName+"_"+n+"_"+s+".png":a.src="/babu-is-you/img/objects/"+m.Objects[t].spriteName+"_"+n+"_"+s+".png";document.createElement("canvas").getContext("2d");a.onload=function(){var o=document.createElement("canvas").getContext("2d");if(null!==o){o.imageSmoothingEnabled=!1,o.drawImage(e,100,100,e.width,e.height);var d=o.getImageData(100,100,e.width,e.height);o.drawImage(a,0,0,24,24);for(var c=o.getImageData(0,0,24,24),h=c.data,u=m.Objects[t].x,l=7*m.Objects[t].y+u<<2,g=0;g<h.length;g+=4)h[g]*=d.data[l]/255,h[g+1]*=d.data[l+1]/255,h[g+2]*=d.data[l+2]/255;var v=document.createElement("canvas");v.width=c.width,v.height=c.height;var f=v.getContext("2d");null!==f&&f.putImageData(c,0,0),r[n][s]=v,i.drawings[t]=r,document.getElementById("loading").textContent="LOADING\n"+(Object.keys(i.drawings).length/(Object.keys(m.Objects).length-1)*100).toFixed(2)+"%",setTimeout((function(){if(i.hasFullyLoaded)return document.getElementById("loading").style.animation="loadingDone 1s linear",document.getElementById("loading").style.animationFillMode="forwards",void i.grid.rules.updateRules()}),100)}}},a=1;a<4;a++)s(a)},h=0;h<a+1;h++)c(h)},n=0,s=Object.keys(m.Objects);n<s.length;n++)t()}}}]),i}(n.Component);S.mainMenu=void 0,S.canvas=void 0,S._grid=void 0,S.drawings={},S.debug=!1,S.resolution=50,S.fastLoading=!1,S.hasLoadedObjects=!1;var P=["babu","keke","wall","is","you","rock","flag","win","push","stop","melt","hot","sink","water","lava","and","ice"],E=function(e){Object(h.a)(i,e);var t=Object(u.a)(i);function i(e,n,s,r,a){var o;return Object(d.a)(this,i),(o=t.call(this,S.canvas,!1)).currentDirection=0,o.lastDirection=1,o.extraWalking=0,o.imageName=void 0,o.drawings=[],o.x=0,o.xLastFrame=0,o.drawX=0,o.xDir=0,o.y=0,o.yLastFrame=0,o.drawY=0,o.yDir=0,o.offset=void 0,o.resolution=void 0,o.hasWalking=!1,o.hasDirections=!1,o.isMoving=!1,o.grid=void 0,o.node=void 0,o.imageName=r,o.grid=s,o.node=a,o.resolution=S.resolution,o.x=e,o.xLastFrame=o.x,o.drawX=e,o.y=n,o.yLastFrame=o.y,o.drawY=n,o.hasDirections=m.Objects[o.imageName].hasDirs,o.hasWalking=m.Objects[o.imageName].hasWalkAni,o}return Object(c.a)(i,[{key:"draw",value:function(){var e=this;if(this.drawings=S.drawings[this.imageName],void 0!==this.drawings&&void 0!==this.drawings[this.currentDirection][this.currentFrame]){if(this.currentDirection=0,this.hasDirections&&(this.currentDirection=0===this.lastDirection?8:1===this.lastDirection?0:2===this.lastDirection?24:3===this.lastDirection?16:0),this.hasWalking&&(this.currentDirection=0===this.lastDirection?8:1===this.lastDirection?0:2===this.lastDirection?24:3===this.lastDirection?16:0,this.x===this.xLastFrame&&this.y===this.yLastFrame||(3!==this.extraWalking?this.extraWalking+=1:this.extraWalking=0),this.currentDirection+=this.extraWalking),this.x===this.xLastFrame&&this.y===this.yLastFrame||(this.xDir=this.x-this.xLastFrame,this.yDir=this.y-this.yLastFrame,this.drawX=this.x-this.xDir,this.drawY=this.y-this.yDir),m.Objects[this.imageName].isTileable&&!this.isMoving){var t=!1,i=!1,n=!1,s=!1;this.x+1>this.grid.width-1||!this.grid.grid[this.y][this.x+1].nodes.some((function(t){return t.objectName===e.imageName}))||(i=!0),this.x-1<0||!this.grid.grid[this.y][this.x-1].nodes.some((function(t){return t.objectName===e.imageName}))||(t=!0),this.y+1>this.grid.height-1||!this.grid.grid[this.y+1][this.x].nodes.some((function(t){return t.objectName===e.imageName}))||(s=!0),this.y-1<0||!this.grid.grid[this.y-1][this.x].nodes.some((function(t){return t.objectName===e.imageName}))||(n=!0),t||!i||n||s?t||i||!n||s?!t&&i&&n&&!s?this.currentDirection+=3:!t||i||n||s?t&&i&&!n&&!s?this.currentDirection+=5:t&&!i&&n&&!s?this.currentDirection+=6:t&&i&&n&&!s?this.currentDirection+=7:t||i||n||!s?!t&&i&&!n&&s?this.currentDirection+=9:!t&&!i&&n&&s?this.currentDirection+=10:!t&&i&&n&&s?this.currentDirection+=11:t&&!i&&!n&&s?this.currentDirection+=12:t&&i&&!n&&s?this.currentDirection+=13:t&&!i&&n&&s?this.currentDirection+=14:t&&i&&n&&s&&(this.currentDirection+=15):this.currentDirection+=8:this.currentDirection+=4:this.currentDirection+=2:this.currentDirection+=1}this.ctx.imageSmoothingEnabled=!1,void 0!==this.drawings[this.currentDirection][this.currentFrame]&&(this.ctx.drawImage(this.drawings[this.currentDirection][this.currentFrame],this.drawX*this.resolution+this.offset.x,this.drawY*this.resolution+this.offset.y,this.resolution,this.resolution),parseFloat(this.drawX.toFixed(1))!==this.x||parseFloat(this.drawY.toFixed(1))!==this.y?(this.drawX+=.2*this.xDir,this.drawY+=.2*this.yDir,this.isMoving=!0,this.node.isMoving=!0):(this.isMoving=!1,this.node.isMoving=!1),this.xLastFrame=this.x,this.yLastFrame=this.y)}}}]),i}(g);var F=function(){return Object(l.jsx)("div",{className:"App",children:Object(l.jsx)("header",{className:"App-header",children:Object(l.jsx)(S,{})})})},B=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,21)).then((function(t){var i=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,a=t.getTTFB;i(e),n(e),s(e),r(e),a(e)}))};a.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(F,{})}),document.getElementById("root")),B()}},[[20,1,2]]]);
//# sourceMappingURL=main.13ffe079.chunk.js.map