{"version":3,"sources":["Game/Canvas.tsx","Game/Node.tsx","Game/rules.ts","Game/Grid.tsx","mobileCheck.ts","GitHub-Mark-64px.png","Game/Reader.ts","Game/MainMenu.tsx","Game/LevelSelect.tsx","Game/Game.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Drawing","canvas","isAutoDrawn","ctx","currentFrame","this","drawings","push","slice","indexOf","Canvas","props","lastFrameTime","FRAMES_PER_SECOND","FRAME_MIN_TIME","frameTime","state","document","getElementById","rescaleCanvas","getContext","window","addEventListener","requestAnimationFrame","draw","bind","time","clearRect","width","height","advanceFrame","drawing","innerWidth","innerHeight","id","Component","Tile","x","y","_nodes","sort","a","b","zIndex","value","Node","grid","imageName","text","objectName","startDirection","isPlayer","_isPushable","_objectName","rules","_lastDirection","aniImg","isMoving","xP","yP","Game","Object","keys","Objects","hasDirs","AnimatedImage","isText","type","rule","direction","Rules","rulesText","innerText","i","nodes","length","curNode","isText_Object","node1","isText_Verb","extraObjects","stop","extra","node3","node4","isText_Special","Array","from","Set","node2","isText_Quality","extraObject","addRule","stop2","extra2","resetAllNodeRules","split","verbName","qualityName","nodesWithObjectName","node","undoActions","changeTo","changeOn","undoStep","doAfterMove","newObjectName","playerPositions","skip","isPushable","Grid","resolution","debug","offset","gridImage","undoMoves","didMoveThisStep","updateGrid","updateRules","calculateText","updateScreenScalings","drawGrid","initializeGrid","resX","resY","num","min","max","check","navigator","userAgent","vendor","opera","test","substr","detectMobile","Math","round","floor","background","localStorage","getItem","style","display","left","toString","top","currentY","setTimeout","e","posX","clientX","posY","clientY","gridPos","prompt","movedNodes","is","xyP","directionToXAndY","lastDirection","canMoveIntoNode","some","filter","playerNode","textScreen","animation","animationFillMode","destroyNode","find","movedNode","moveNode","skipPushable","nextNode","j","skipMoveCheck","skipAddUndoCheck","reverseDirection","curTile","nextTile","splice","findIndex","doAction","imageSmoothingEnabled","drawImage","zI","createElement","globalCompositeOperation","strokeStyle","fillStyle","lineWidth","beginPath","moveTo","lineTo","stroke","Item","ID","Name","Active","Sprite","Tiling","Color","Type","DefaultsById","DefaultsByName","GenerateDefault","console","log","fetch","process","then","res","data","lines","line","startIndex","maxID","trim","index","item","substring","parseInt","obj","toLowerCase","includes","replace","SetItemValue","itemKey","hasWalkAni","isTileable","spriteName","hasLoadedObjects","SetupObjects","ReadAllObjectLines","loadGrid","loadAllImages","CoordinateToObject","coordinate","endIndex","CoordinateToShort","ReadMap","result","hex","byteStr","charCodeAt","hexArr","shift","position","layerCount","binArrayToNumb","ReadLayer","error","size","compressed_size","compressed","compArray","Uint8Array","map","byte","buffer","pako","inflate","map_buffer","tmp","items","k","assign","create","getPrototypeOf","arr","MainMenu","isInMain","isInSettings","isInCredits","className","src","alt","fontFamily","onMouseEnter","onMouseOut","onClick","forceUpdate","setItem","marginTop","textAlign","LevelSelect","worldLevel","worldMap","gridLevel","levels","blob","reader","FileReader","onload","readAsBinaryString","ref","el","canMove","justUndone","interval","intervalW","intervalD","intervalS","intervalA","percentage","instance","keyDetectDown","keyDetectUp","fastLoading","_grid","doExtra","pos","findPlayerNode","v","doMovement","howManyRulesNotYou","undoMove","undoAction","repeat","hasFullyLoaded","key","movePlayers","setInterval","clearInterval","mainMenu","levelSelector","href","target","rel","onChange","file","files","ReadMapFromBrowseFile","fontSize","palette","Image","tempDraw","localDrawings","amountOfDirections","undefined","img","paletteData","getImageData","imageData","imgData","posForColor","canvas2","ctx2","putImageData","textContent","toFixed","showLevelSelect","currentDirection","extraWalking","xLastFrame","drawX","xDir","yLastFrame","drawY","yDir","hasWalking","hasDirections","hasLeft","hasRight","hasTop","hasBottom","parseFloat","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.b9df4a1f.chunk.js","sourcesContent":["import {Component} from \"react\";\n\nexport class Drawing {\n    public canvas: Canvas;\n    public ctx: CanvasRenderingContext2D;\n    public currentFrame: number = 1;\n    public isAutoDrawn: boolean;\n    constructor(canvas: Canvas, isAutoDrawn: boolean = true) {\n        this.canvas = canvas;\n        this.isAutoDrawn = isAutoDrawn;\n        this.canvas.drawings.push(this);\n        this.ctx = canvas.ctx;\n    }\n\n    draw() {\n\n    }\n\n    remove() {\n        this.canvas.drawings.slice(this.canvas.drawings.indexOf(this), 1)\n    }\n}\n\nexport default class Canvas extends Component {\n\n    public drawings: Array<Drawing> = []\n\n    public canvas!: any\n    public ctx! : CanvasRenderingContext2D ;\n\n    private lastFrameTime!: number;\n    public FRAMES_PER_SECOND: number = 60;\n    private readonly FRAME_MIN_TIME;\n    public frameTime: number = 0;\n\n\n    constructor(props: any) {\n        super(props);\n        this.state = {}\n        this.FRAME_MIN_TIME = (1000/60) * (60 / this.FRAMES_PER_SECOND) - (1000/60) * 0.5;\n    }\n\n    componentDidMount() {\n        this.canvas = document.getElementById(\"canvas\");\n        this.rescaleCanvas()\n        this.ctx = this.canvas!.getContext(\"2d\")\n        window.addEventListener(\"resize\", this.rescaleCanvas)\n        window.requestAnimationFrame(this.draw.bind(this))\n    }\n\n    draw(time: number) {\n        const deltaTime = time - this.lastFrameTime\n        if (deltaTime < this.FRAME_MIN_TIME) {\n            window.requestAnimationFrame(this.draw.bind(this));\n            return;\n        }\n\n        this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)\n        this.lastFrameTime = time;\n\n        this.frameTime+=(1/(this.FRAMES_PER_SECOND))\n        let advanceFrame = false;\n        if((this.frameTime % 1) > 0.225){\n            this.frameTime = 0;\n            advanceFrame = true;\n        }\n\n        for (const drawing of this.drawings) {\n            if(drawing.isAutoDrawn) {\n                drawing.draw()\n            }\n            if(advanceFrame) {\n                if(drawing.currentFrame !== 3) {\n                    drawing.currentFrame++;\n                } else  {\n                    drawing.currentFrame = 1;\n                }\n            }\n        }\n\n        window.requestAnimationFrame(this.draw.bind(this))\n    }\n\n    rescaleCanvas() {\n        this.canvas.width = window.innerWidth;\n        this.canvas.height = window.innerHeight\n    }\n\n    render() {\n        return (\n            <canvas id={\"canvas\"}/>\n        )\n    }\n}","import Grid from \"./Grid\";\nimport Canvas from \"./Canvas\";\nimport Game, {AnimatedImage} from \"./Game\";\n\nexport default class Tile {\n    public x:number;\n    public y:number;\n    private _nodes:Array<Node> = []\n\n    get nodes(): Array<Node> {\n        return this._nodes.sort((a,b) => {\n\n            if(a.zIndex > b.zIndex) {\n                return 1;\n            }\n            if(a.zIndex < b.zIndex) {\n                return -1;\n            }\n            return 0;\n        });\n    }\n\n    set nodes(value: Array<Node>) {\n        this._nodes = value;\n    }\n\n    constructor(x:number, y:number) {\n        this.x = x;\n        this.y = y;\n    }\n}\n\nexport class Node {\n    get objectName(): string {\n        return this._objectName;\n    }\n\n    set objectName(value: string) {\n        this._objectName = value;\n        if(value !== \"\") {\n            this.aniImg = new AnimatedImage(this.x, this.y,this.grid,value, this)\n        } else {\n            this.aniImg = null;\n        }\n    }\n\n    // Text\n    get isText(): boolean {\n        return this.text !== \"\"\n    }\n\n    get zIndex(): number {\n        if(this._objectName === \"\") {\n            if(Object.keys(Node.Objects).indexOf(\"text_\"+this.text) !== -1) {\n                return Node.Objects[\"text_\"+this.text].zIndex\n            }\n        } else {\n            return Node.Objects[this._objectName].zIndex\n        }\n        return 0;\n    }\n\n\n    get isPushable(): boolean {\n        if(this.isText) return true;\n        return this._isPushable;\n    }\n\n    set isPushable(value: boolean) {\n        this._isPushable = value;\n    }\n\n    // Is object, verb or quality\n    get isText_Object(): boolean {\n        if(this.isText) {\n            return Node.Objects[\"text_\"+this.text].type === 0;\n        }\n        return false;\n    }\n    get isText_Verb(): boolean {\n        if(this.isText) {\n            return Node.Objects[\"text_\"+this.text].type === 1;\n        }\n        return false;\n    }\n    get isText_Quality(): boolean {\n        if(this.isText) {\n            return Node.Objects[\"text_\" + this.text].type === 2;\n        }\n        return false;\n    }\n    get isText_Special():boolean {\n        if(this.isText) {\n            return Node.Objects[\"text_\" + this.text].type === 6;\n        }\n        return false;\n    }\n\n    is(rule: string): boolean {\n        return this.rules.indexOf(rule) !== -1;\n    }\n\n    lastDirection():number {\n        if(this.xP === 0 && this.yP === -1) {\n            this._lastDirection = 0;\n            return 0;\n        }\n        if(this.xP === 1 && this.yP === 0) {\n            this._lastDirection = 1;\n            return 1;\n        }\n        if(this.xP === 0 && this.yP === 1) {\n            this._lastDirection = 2;\n            return 2;\n        }\n        if(this.xP === -1 && this.yP === 0) {\n            this._lastDirection = 3;\n            return 3;\n        }\n        return this._lastDirection;\n    }\n\n    directionToXAndY(direction: number): {xP:number, yP:number} {\n        if(direction === 0) {\n            return {xP: 0, yP: -1}\n        }\n        if(direction === 1) {\n            return {xP: 1, yP: 0}\n        }\n        if(direction === 2) {\n            return {xP: 0, yP: 1}\n        }\n        if(direction === 3) {\n            return {xP: -1, yP: 0}\n        }\n        return {xP: 0, yP: 0}\n    }\n\n    public x: number;\n    public y: number;\n    public text: string;\n    public isPlayer: boolean = false;\n    private _isPushable: boolean = false;\n    private _objectName: string;\n    public rules: Array<string> = [];\n    private _lastDirection: number = 1;\n    public aniImg: AnimatedImage | null;\n    public isMoving: boolean = false;\n    private canvas: Canvas;\n    private grid: Grid;\n\n    xP: number = 0;\n    yP: number = 0;\n\n    constructor(x:number,y:number,grid:Grid, text:string = \"\", objectName:string = \"\", startDirection:number = 1) {\n        this.x = x;\n        this.y = y;\n        this.text = text;\n        this._objectName = objectName\n        this.canvas = Game.canvas;\n        this.grid = grid;\n        if((Object.keys(Node.Objects).indexOf(objectName) !== -1)) {\n            if(startDirection === 1 && objectName === \"\" ? false : Node.Objects[objectName].hasDirs) {\n                this._lastDirection = 2\n            } else {\n                this._lastDirection = startDirection;\n            }\n        }\n        let imageName;\n        if(objectName === \"\") {\n            imageName = \"text_\"+text;\n        } else {\n            imageName = objectName;\n        }\n        this.aniImg = new AnimatedImage(x,y,grid, imageName, this)\n    }\n    static Objects: {[key:string]: {\n            x:number,\n            y:number,\n            type:number,\n            zIndex:number,\n            hasWalkAni: boolean,\n            hasDirs: boolean,\n            isTileable: boolean,\n            spriteName: string\n    }} = {}\n}\n\n","import Grid from \"./Grid\";\nimport {Node} from \"./Node\";\n\nexport default class Rules {\n    public grid: Grid;\n    public rules: Array<string> = [];\n\n    constructor(grid: Grid) {\n        this.grid = grid;\n    }\n\n    updateRules() {\n        this.rules = [];\n        const grid = this.grid.grid;\n        const rulesText = document.getElementById(\"rules-text\")\n        if(rulesText != null) {\n            rulesText.innerText = \"\"\n        }\n        // convert every rule in blocks on the grid into an array with rules\n        for (let y = 0; y < this.grid.height; y++) {\n            for (let x = 0; x < this.grid.width; x++) {\n                for (let i = 0; i < grid[y][x].nodes.length; i++) {\n                    const curNode = grid[y][x].nodes[i];\n                    if(curNode.isText_Object) {\n                        if(x+1 !< this.grid.width && x+2 !< this.grid.width) {\n                            for (const node1 of grid[y][x+1].nodes) {\n                                if(node1.isText_Verb && node1.text === \"is\") {\n\n                                    let extraObjects = []\n\n                                    // do extra and's\n                                    let stop = false;\n                                    let extra = 2;\n                                    while(!stop) {\n                                        if(x-extra > 0 && x-extra+1 > 0) {\n                                            for (const node3 of grid[y][x-extra].nodes) {\n                                                if(node3.isText_Object) {\n                                                    for (const node4 of grid[y][x-extra+1].nodes) {\n                                                        if (node4.isText_Special && node4.text === \"and\") {\n                                                            extraObjects.push(node3.text)\n                                                        } else {\n                                                            stop = true;\n                                                        }\n                                                    }\n                                                } else {\n                                                    stop = true;\n                                                }\n                                            }\n                                        } else {\n                                            stop = true;\n                                        }\n                                        extra+=2;\n                                    }\n\n                                    // Remove duplicates\n                                    extraObjects = Array.from(new Set(extraObjects))\n\n                                    for (const node2 of grid[y][x+2].nodes) {\n                                        if (node2.isText_Quality || node2.isText_Object) {\n                                            for (const extraObject of extraObjects) {\n                                                this.addRule(extraObject + \" \" + node1.text + \" \" + node2.text)\n                                            }\n                                            this.addRule(curNode.text + \" \" + node1.text + \" \" + node2.text)\n\n                                            // do extra and's\n                                            let stop2 = false;\n                                            let extra2 = 3;\n                                            while(!stop2) {\n                                                if(x+extra2 !< this.grid.width && x+extra2+1 !< this.grid.width) {\n                                                    for (const node3 of grid[y][x+extra2].nodes) {\n                                                        if(node3.isText_Special && node3.text === \"and\") {\n                                                            for (const node4 of grid[y][x+extra2+1].nodes) {\n                                                                if (node4.isText_Quality || node4.isText_Object) {\n                                                                    for (const extraObject of extraObjects) {\n                                                                        this.addRule(extraObject + \" \" + node1.text + \" \" + node4.text)\n                                                                    }\n                                                                    this.addRule(curNode.text + \" \" + node1.text + \" \" + node4.text)\n                                                                } else {\n                                                                    stop2 = true;\n                                                                }\n                                                            }\n                                                        } else {\n                                                            stop2 = true;\n                                                        }\n                                                    }\n                                                } else {\n                                                    stop2 = true;\n                                                }\n                                                extra2+=2;\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        if(y+1 !< this.grid.height && y+2 !< this.grid.height) {\n                            for (const node1 of grid[y+1][x].nodes) {\n                                if(node1.isText_Verb && node1.text === \"is\") {\n\n                                    let extraObjects = []\n\n                                    // do extra and's\n                                    let stop = false;\n                                    let extra = 2;\n                                    while(!stop) {\n                                        if(y-extra > 0 && y-extra+1 > 0) {\n                                            for (const node3 of grid[y-extra][x].nodes) {\n                                                if(node3.isText_Object) {\n                                                    for (const node4 of grid[y-extra+1][x].nodes) {\n                                                        if (node4.isText_Special && node4.text === \"and\") {\n                                                            extraObjects.push(node3.text)\n                                                        } else {\n                                                            stop = true;\n                                                        }\n                                                    }\n                                                } else {\n                                                    stop = true;\n                                                }\n                                            }\n                                        } else {\n                                            stop = true;\n                                        }\n                                        extra+=2;\n                                    }\n\n                                    // Remove duplicates\n                                    extraObjects = Array.from(new Set(extraObjects))\n\n\n                                    for (const node2 of grid[y+2][x].nodes) {\n                                        if (node2.isText_Quality || node2.isText_Object) {\n                                            for (const extraObject of extraObjects) {\n                                                this.addRule(extraObject + \" \" + node1.text + \" \" + node2.text)\n                                            }\n                                            this.addRule(curNode.text + \" \" + node1.text + \" \" + node2.text)\n\n                                            // do extra and's\n                                            let stop2 = false;\n                                            let extra2 = 3;\n                                            while(!stop2) {\n                                                if(y+extra2 !< this.grid.height && y+extra2+1 !< this.grid.height) {\n                                                    for (const node3 of grid[y+extra2][x].nodes) {\n                                                        if(node3.isText_Special && node3.text === \"and\") {\n                                                            for (const node4 of grid[y+extra2+1][x].nodes) {\n                                                                if (node4.isText_Quality || node4.isText_Object) {\n                                                                    for (const extraObject of extraObjects) {\n                                                                        this.addRule(extraObject + \" \" + node1.text + \" \" + node4.text)\n                                                                    }\n                                                                    this.addRule(curNode.text + \" \" + node1.text + \" \" + node4.text)\n                                                                } else {\n                                                                    stop2 = true;\n                                                                }\n                                                            }\n                                                        } else {\n                                                            stop2 = true;\n                                                        }\n                                                    }\n                                                } else {\n                                                    stop2 = true;\n                                                }\n                                                extra2+=2;\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        // Removes duplicates from rules array\n        this.rules = Array.from(new Set(this.rules))\n\n        this.resetAllNodeRules()\n\n        // go though every rule\n        for (const rule of this.rules) {\n            const rules = rule.split(\" \");\n            // like baba\n            const objectName = rules[0];\n            // like is\n            const verbName = rules[1];\n            // like you or stop\n            const qualityName = rules[2];\n\n            let nodesWithObjectName = [];\n            for (let y = 0; y < this.grid.height; y++) {\n                for (let x = 0; x < this.grid.width; x++) {\n                    for (let i = 0; i < this.grid.grid[y][x].nodes.length; i++) {\n                        const node = this.grid.grid[y][x].nodes[i]\n                        if (node.objectName === objectName && verbName === \"is\") {\n                            nodesWithObjectName.push(node)\n                        }\n                    }\n                }\n            }\n\n            for (const node of nodesWithObjectName) {\n                if(Object.keys(Node.Objects).indexOf(qualityName) !== -1) {\n                    // this.grid.playerPositions = []\n\n                    this.grid.undoActions.push({node: node, changeTo: node.objectName, changeOn: this.grid.undoStep+1})\n\n                    this.grid.doAfterMove.push({node: node, newObjectName: qualityName })\n                }\n                switch (qualityName) {\n                    case \"you\": {\n                        node.isPlayer = true;\n                        this.grid.playerPositions.push({x:node.x,y:node.y, skip:false});\n                        break;\n                    }\n                    case \"push\": {\n                        node.isPushable = true;\n                        break;\n                    }\n                    default: {\n                        node.rules.push(qualityName)\n                        break;\n                    }\n\n                }\n            }\n            if(rulesText != null) {\n                rulesText.innerText += rule+\"\\n\";\n            }\n        }\n    }\n\n    resetAllNodeRules() {\n        this.grid.playerPositions = []\n        const grid = this.grid.grid;\n        for (let y = 0; y < this.grid.height; y++) {\n            for (let x = 0; x < this.grid.width; x++) {\n                for (let i = 0; i < grid[y][x].nodes.length; i++) {\n                    const node = grid[y][x].nodes[i]\n                    node.isPlayer = false;\n                    node.isPushable = false;\n                    node.rules = [];\n                }\n            }\n        }\n    }\n\n    addRule(rule:string) {\n        this.rules.push(rule);\n    }\n}","import Canvas, {Drawing} from \"./Canvas\";\nimport Tile, {Node} from \"./Node\";\nimport Rules from \"./rules\";\nimport {detectMobile} from \"../mobileCheck\";\n\nexport default class Grid extends Drawing {\n    public width: number\n    public height: number\n\n    public resolution: number\n\n    public grid: Array<Array<Tile>> = [];\n    private offset!: { x: number; y: number };\n\n    public playerPositions: Array<{ x: number; y: number, skip: boolean }> = [];\n\n    private gridImage: any;\n\n    public undoMoves: Array<Array<{node:Node, xP: number; yP: number, doAction: boolean}>> = [];\n    public undoActions: Array<{node: Node, changeTo: any, changeOn: number}> = [];\n\n    public doAfterMove: Array<{node: Node, newObjectName: string}> = []\n\n    public undoStep = 0;\n    public rules: Rules = new Rules(this);\n\n    public didMoveThisStep: boolean = false;\n    private debug: boolean;\n\n    constructor(canvas: Canvas, width: number, height: number, resolution: number, debug: boolean = false) {\n        super(canvas)\n        this.width = width;\n        this.height = height;\n        this.resolution = resolution;\n        this.debug = debug;\n\n        this.updateGrid(width, height)\n\n        this.rules.updateRules()\n        this.canvas.canvas.addEventListener('click', this.calculateText.bind(this));\n    }\n\n    updateGrid(width: number, height: number) {\n        this.debug = false;\n        this.grid = [];\n        this.undoStep = 0;\n        this.undoMoves = [];\n        this.undoActions = []\n        this.width = width;\n        this.height = height;\n        this.updateScreenScalings();\n        this.gridImage = this.drawGrid()\n        this.initializeGrid(width, height)\n    }\n\n\n    updateScreenScalings() {\n        let resX;\n        let resY;\n        if(detectMobile()) {\n            resX = (window.innerWidth-10) / this.width\n            resY = (window.innerHeight-10) / this.height;\n        } else {\n            resX = (window.innerWidth-100) / this.width\n            resY = (window.innerHeight-100) / this.height;\n        }\n        this.resolution = clamp(Math.round(Math.min(resX, resY)), 5, 150)\n        this.offset = {x:Math.floor(window.innerWidth/2-(this.width/2*this.resolution)), y:Math.floor(window.innerHeight/2-(this.height/2*this.resolution))}\n        this.gridImage = this.drawGrid()\n        let background = document.getElementById(\"background\");\n        if (background) {\n            if(localStorage.getItem(\"grid\") === \"false\") {\n                background.style.display = \"block\";\n\n                background.style.left = this.offset.x.toString() + \"px\";\n                background.style.top = this.offset.y.toString() + \"px\";\n                background.style.width = this.width * this.resolution + \"px\";\n                background.style.height = this.height * this.resolution + \"px\";\n            } else {\n                background.style.display = \"none\";\n            }\n        }\n    }\n\n    initializeGrid(width:number, height:number) {\n        for (let y = 0; y < height; y++) {\n            const currentY = []\n            for (let x = 0; x < width; x++) {\n                currentY.push(new Tile(x,y))\n            }\n            this.grid.push(currentY)\n        }\n        if(this.debug) {\n            setTimeout(() => {\n                for (let y = 0; y < height; y++) {\n                    for (let x = 0; x < width; x++) {\n                        if((x===5 && y===5)) {\n                            this.grid[y][x].nodes.push(new Node(x,y, this,\"\", 'babu'))\n                        }\n                        if((x===7 && y===5)) {\n                            this.grid[y][x].nodes.push(new Node(x,y,this,\"\", 'keke'));\n                            // this.grid[y][x].nodes.push(new Node(x,y,\"\", 'me'))\n                        }\n                        if((x===8 && y===5)) {\n                            // this.grid[y][x].nodes.push(new Node(x,y,this.canvas,this,\"\", 'wall'));\n                        }\n\n                        if((x===3 && y===3)) {\n                            this.grid[y][x].nodes.push(new Node(x,y,this,\"babu\"))\n                        }\n                        if((x===4 && y===3)) {\n                            this.grid[y][x].nodes.push(new Node(x,y,this,\"is\"))\n                        }\n                        if((x===5 && y===3)) {\n                            this.grid[y][x].nodes.push(new Node(x,y,this,\"you\"));\n                        }\n                        //\n                        if((x===6 && y===3)) {\n                            this.grid[y][x].nodes.push(new Node(x,y,this,\"and\"))\n                        }\n                        if((x===7 && y===3)) {\n                            this.grid[y][x].nodes.push(new Node(x,y,this,\"stop\"));\n                        }\n                        // if((x===9 && y===4)) {\n                        //     this.grid[y][x].nodes.push(new Node(x,y,this,\"sink\"))\n                        // }\n                        // if((x===7 && y===6)) {\n                        //     this.grid[y][x].nodes.push(new Node(x,y,this.canvas,\"me\"))\n                        // }\n                    }\n                }\n            }, 5000)\n        }\n    }\n\n    calculateText(e: any) {\n        const posX = e.clientX - this.offset.x;\n        const posY = e.clientY - this.offset.y;\n        const gridPos = {x: Math.floor(posX/this.resolution), y: Math.floor(posY/this.resolution)}\n        if(gridPos.x < 0 || gridPos.x >= this.width || gridPos.y < 0 || gridPos.y >= this.height) {\n            return;\n        }\n        const text = prompt(\"Give a value.\")\n        if(text !== null) {\n            // if(objectNames.indexOf(text) !== -1) {\n            //     this.grid[gridPos.y][gridPos.x].nodes.push(new Node(gridPos.x,gridPos.y,\"\", text))\n            // } else {\n            this.grid[gridPos.y][gridPos.x].nodes.push(new Node(gridPos.x,gridPos.y,this,text))\n            // }\n        }\n        this.rules.updateRules();\n    }\n\n    //#region moving\n\n    doMovement() {\n        let movedNodes = []\n        for (let y = 0; y < this.height; y++) {\n            for (let x = 0; x < this.width; x++) {\n                for (const node of this.grid[y][x].nodes) {\n                    if(node.is(\"move\")) {\n                        let xyP = node.directionToXAndY(node.lastDirection())\n                        if(!this.canMoveIntoNode(node, xyP.xP, xyP.yP)) {\n                            xyP = {xP:-xyP.xP, yP:-xyP.yP}\n                        }\n                        movedNodes.push({node:node, xP:xyP.xP, yP:xyP.yP})\n                    }\n                    // boilerplate for is player on something\n                    if(node.is(\"defeat\")) {\n                        if(this.grid[y][x].nodes.some(value => value.isPlayer)) {\n                            for (const playerNode of this.grid[y][x].nodes.filter(value => value.isPlayer)) {\n                                this.undoActions.push({node: playerNode, changeTo: playerNode.objectName, changeOn: this.undoStep+1})\n                                playerNode.objectName = \"\";\n                            }\n                        }\n                    }\n                    if(node.is(\"win\")) {\n                        if(this.grid[y][x].nodes.some(value => value.isPlayer)) {\n                            const textScreen = document.getElementById(\"loading\");\n                            textScreen!.innerText = \"CONGRATULATIONS\"\n                            textScreen!.style.display = \"\";\n                            textScreen!.style.animation = \"winScreen 4s linear\";\n                            textScreen!.style.animationFillMode = \"forwards\"\n                            textScreen!.addEventListener(\"animationend\", () => {\n                                textScreen!.style.animation = \"\";\n                                textScreen!.style.display = \"none\";\n                            })\n                        }\n                    }\n                    if(node.is(\"sink\")) {\n                        if(this.grid[y][x].nodes.some(value => !value.is(\"sink\"))) {\n                            const destroyNode = this.grid[y][x].nodes.find(value => !value.is(\"sink\"))\n                            if(destroyNode){\n                                this.undoActions.push({node: destroyNode, changeTo: destroyNode.objectName, changeOn: this.undoStep+1})\n                                destroyNode.objectName = \"\";\n                                this.undoActions.push({node: node, changeTo: node.objectName, changeOn: this.undoStep+1})\n                                node.objectName = \"\";\n                            }\n                        }\n                    }\n                    if(node.is(\"hot\")) {\n                        for (const destroyNode of this.grid[y][x].nodes.filter(value => value.is(\"melt\"))) {\n                            this.undoActions.push({node: destroyNode, changeTo: destroyNode.objectName, changeOn: this.undoStep+1})\n                            destroyNode.objectName = \"\";\n                        }\n                    }\n                }\n            }\n        }\n\n        for (const movedNode of movedNodes) {\n            this.moveNode(movedNode.node, movedNode.xP, movedNode.yP)\n        }\n    }\n\n    canMoveIntoNode(node:Node, xP:number, yP:number, skipPushable:boolean = false) {\n        const grid = this.grid;\n\n        const x = node.x;\n        const y = node.y;\n        // return if coords out of bounds\n        if(x+xP < 0 || x+xP > this.width-1 || y+yP < 0 || y+yP > this.height-1) return false;\n        for (let i = 0; i < grid[y+yP][x+xP].nodes.length; i++) {\n            const nextNode = grid[y+yP][x+xP].nodes[i];\n            if(!skipPushable && nextNode.isPushable) {\n                // return if coords out of bounds\n                if(nextNode.x+xP < 0 || nextNode.x+xP > this.width-1 || nextNode.y+yP < 0 || nextNode.y+yP > this.height-1) return false;\n\n                // if next tile empty you can move\n                if(grid[nextNode.y+yP][nextNode.x+xP].nodes.length === 0) {\n                    this.moveNode(nextNode, xP,yP, true)\n                    return true;\n                }\n                for (let j = 0; j < grid[nextNode.y+yP][nextNode.x+xP].nodes.length; j++) {\n                    if(this.canMoveIntoNode(nextNode, xP, yP)) {\n                        this.moveNode(nextNode, xP,yP, true)\n                        return true;\n                    }\n                }\n                return false;\n            } else if(nextNode.is('stop')) {\n                return false\n            }\n        }\n        return true;\n    }\n\n    moveNode(node: Node, xP:number, yP:number, skipMoveCheck:boolean = false, skipAddUndoCheck:boolean = false, reverseDirection:boolean = false, skipPushable:boolean = false): boolean {\n\n        if(!skipMoveCheck && !this.canMoveIntoNode(node, xP, yP, skipPushable)) {\n            return false;\n        }\n\n        const curTile = this.grid[node.y][node.x];\n        const nextTile = this.grid[node.y+yP][node.x+xP];\n\n        node.x += xP;\n        node.y += yP;\n\n        if(reverseDirection) {\n            node.xP = -xP\n            node.yP = -yP;\n        } else {\n            node.xP = xP\n            node.yP = yP;\n        }\n\n        nextTile.nodes.push(node);\n        curTile.nodes.splice(curTile.nodes.indexOf(node), 1);\n\n        // Undo moves\n        if(!skipAddUndoCheck) {\n            this.didMoveThisStep = true;\n            if(this.undoMoves.length-1 !== this.undoStep) {\n                this.undoMoves.push([]);\n            }\n            this.undoMoves[this.undoStep].push({node:nextTile.nodes[nextTile.nodes.findIndex(value => value === node)], xP: -xP,yP: -yP, doAction:false});\n        }\n        return true;\n    }\n\n    //#endregion\n\n    //#region drawing\n\n    draw() {\n        this.ctx.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height)\n        this.ctx.imageSmoothingEnabled = false\n\n        if(localStorage.getItem(\"grid\") === \"true\") {\n            this.ctx.drawImage(this.gridImage, this.offset.x, this.offset.y)\n        }\n        // else {\n        //     this.ctx.fillStyle = '#080808';\n        //     this.ctx.rect(this.offset.x, this.offset.y, this.gridImage.width, this.gridImage.height)\n        //     this.ctx.fill();\n        // }\n\n        for (let zI = 0; zI < 25; zI++) {\n            for (let y = 0; y < this.height; y++) {\n                for (let x = 0; x < this.width; x++) {\n                    for (let j = 0; j < this.grid[y][x].nodes.length; j++){\n                        const node = this.grid[y][x].nodes[j];\n                        if(node.objectName !== \"\") {\n                            if(Node.Objects[node.objectName].zIndex !== zI) continue\n\n\n                            const drawing = node.aniImg;\n                            if(drawing !== null) {\n                                drawing.x = x;\n                                drawing.y = y;\n                                drawing.grid = this;\n                                drawing.lastDirection = node.lastDirection();\n                                drawing.resolution = this.resolution;\n                                drawing.offset = this.offset;\n                                drawing.draw()\n                            }\n                        }\n                        if(node.isText) {\n                            if(Node.Objects[\"text_\"+node.text].zIndex !== zI) continue\n\n                            const drawing = node.aniImg;\n                            if(drawing !== null) {\n                                drawing.x = x;\n                                drawing.y = y;\n                                drawing.grid = this;\n                                drawing.resolution = this.resolution;\n                                drawing.offset = this.offset;\n                                drawing.draw()\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    drawGrid() {\n        const width = this.width;\n        const height = this.height;\n        const resolution = this.resolution;\n\n        const canvas = document.createElement('canvas')\n        canvas.width = width*resolution\n        canvas.height = height*resolution\n        const ctx = canvas.getContext('2d');\n        if(ctx) {\n            ctx.imageSmoothingEnabled = false\n            ctx.globalCompositeOperation = 'source-over';\n            ctx.strokeStyle = 'rgba(0,0,0,1)'\n            ctx.fillStyle = \"rgba(0,0,0,1)\";\n            ctx.lineWidth = Math.round(Math.max(this.resolution/40, 1))\n            ctx.beginPath();\n            for (let x = 0; x < width; x++) {\n                ctx.moveTo(x*resolution, 0);\n                ctx.lineTo(x*resolution, height*resolution);\n            }\n            ctx.stroke();\n            ctx.beginPath();\n            for (let y = 0; y < width; y++) {\n                ctx.moveTo(0, y*resolution);\n                ctx.lineTo(width*resolution, y*resolution);\n            }\n            ctx.stroke();\n\n            ctx.beginPath();\n            ctx.moveTo(width*resolution, 0);\n            ctx.lineTo(width*resolution, height*resolution);\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.moveTo(0, height*resolution);\n            ctx.lineTo(width*resolution, height*resolution);\n            ctx.stroke();\n\n        }\n        return canvas;\n    }\n\n    //#endregion\n}\n\nfunction clamp(num:number, min:number, max:number): number {\n    return Math.min(Math.max(num,min),max)\n}","\nexport function detectMobile() {\n    let check = false;\n    // @ts-ignore\n    (function(a){if(/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series([46])0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br([ev])w|bumb|bw-([nu])|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do([cp])o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly([-_])|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-([mpt])|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c([- _agpst])|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac([ \\-/])|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja([tv])a|jbro|jemu|jigs|kddi|keji|kgt([ /])|klon|kpt |kwc-|kyo([ck])|le(no|xi)|lg( g|\\/([klu])|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t([- ov])|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30([02])|n50([025])|n7(0([01])|10)|ne(([cm])-|on|tf|wf|wg|wt)|nok([6i])|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan([adt])|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c([-01])|47|mc|nd|ri)|sgh-|shar|sie([-m])|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel([im])|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c([- ])|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);\n    return check;\n}","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzlFQkFERkU4NkJCMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MzlFQkFERkQ4NkJCMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJFOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJGOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Kk5lQwAABYxJREFUeNrkm29oVXUYx3+7bM3V1FnbqlltrtXWtYRa1nqxooY5E7EhKWGuaTDBagol9SIMDCKICASj+cISw/DPi16ZBakrUBnoC7nNoTMWy6I1c+LmVq6t78N9jpyu555znt855+536IHPi939/jzP95zznN+/kzc1NaUitirwJJgPasF94DZQDG7hMqNgBFwEZ5kU+AH0R+lcXgQCJMBT4EXwLKgM2N7P4FvwJegCk6YKUA5eB23grogu2C/gc7AN/GGKABTsZtAOZqjc2DjYAT5kUfSNBNCkAGwGo1PTZ6PsQ4FuHLp3QD3YDR5QZtgZsAac1ElYokcGbATHDApesS/kUwf7GEkOKAK7wAvKbNsPXgZjYQowG3wNnlDxsONgCbgchgAU/GHwiIqXUT5o8hLBKwfcDA7FMHgrUR/iGLQEoGTyBWhQ8bUGjiFPR4A3QIuKv7VwLKIcQMnue5Dv0fjT/IwtAM3g+RyMBmkU+BXf3qc5Rx3xqDPBE7LjfkaCheCcj1HYKYe6JeBt8GcEo75L3HaJQ7+nfNQ/x7H9p67TFX4L1Pi4EocdfhsGH4BPwVbwqu0xGwI/8vT2N/77Gv+vAJSCO3n6PJ//Vjz72w62cPtORnfAwx7+1nBsW93ugGow7vOKtPkYa9eDl0Clxji9kuvW+yjb5tPncY7xet3MhjoFt2RzgIlU2DQL/O6017W/Be4BawXJqMCgTH+ToOxajvWG1+AmYVBlBglQKrxwmzIFoB9XCzt91CABpL6sti62JcBiXtKS2GMGCSD1pZxjvi7AKmED9PraYJAAG2yvVL+2yi7AImHl90C3QQJ03/B+97ZF1lCYVlN6BBV/BffykNQkoyF4H5grqJOkO6BR2NF2A4O35gifCOs0JjTW9vYaPPPbJ11LJAFqBRVoDf68wQLQI3BBUL424XPiY1lvDOb/ZwRla0iAOYIKv8dAgEFB2VtJgJmCChMxEEAyHigmAQoFFWbFQIDZgrKF0p2hmTEQQOQjCTAmKD8vBgJUCcqOkQBXBBXosEORwcEXKdmBjCskwICgQr5h0+BMW6i8V7LtNkAC9As7WWqwAM8Jy/cnhBMhspVKvq2eC0uwbxLrSWhMa+dpdJQLW6mRpLtpOlyuMcL7CTwErhoSPG2ApjQEuD3BQ0fp0ZJqlT6pZYpt0wieYh60nuWDGp2+At4xIPgt7IvU0jHzBkFdgD27HWDGNGyGFHHfulaXuTN0IkBjZ8EykJeDwKmPFtAXwN8TTltjrVkKfwcawXJW3G3v8DTYCKoiCLwGvAl6QthpbnU6J5jP2f1uh1Wgxbbxwv0qvT/vtZRGA6wuzs50+Pkb8JdgQtPMq1VJld7bnxtSzhjgJD5hzwEW611OZK6xlSvzeYbAsl3Cx4PK7ozodOl6t93hfJByqbzOVnYh+MdHhxfBLI1bnuoMhRx8imPMKgDR5LG/nrSVfddHpx8HeO4/ClmApsw+snXsdk7gYMat+r5Hp0sDCLAkxOA7nfrI1nGxx2tmQUb5x8FuzgvD4Dw4wNm2MIAA1SEF38cx+RaAeBCMZGlwb44GOyUhBD/CsTj24TatpddXq3L+RIVmXnE4QzjJMaSylvBxFdqzKHsVrDD8Dmj36sOvIx0unewHDRENg4MI0BH2FyP0RcZOlzW3Ib7VLvPqDK0z1PEq7bDmLVwCLgnr0AhvnUp/0eJp0k9m6HO4fUp2nGZODgUY5PzUJVlHkxg1TEfnjxqY8I6yb12SSjqLm7T9/Ax4TaW/+JxuIx862KcL4toBk1QFT1omXZLRHQHaL3Npl/r8jH3QjiGsbJ3kGd/fDo6WBWi31KG9a9xXMgzfw35tVfCR9l52dk8Ibe7htnq57YowfY7i4+lYWUL9z+1fAQYACqstE4NCc18AAAAASUVORK5CYII=\"","import pako from 'pako';\nimport Game from \"./Game\";\nimport {Node} from \"./Node\";\n\nclass Item {\n    ID: number = -1;\n    Name: string = \"\";\n    Active: boolean;\n    x:number = 0;\n    y:number = 0;\n    Sprite: string = \"\";\n    direction: number = 1;\n    Tiling: number = -1;\n    Color!: {x:number, y:number}\n    zIndex: number = 13;\n    Type: number = 0;\n\n\n    constructor() {\n        this.Active = true\n    }\n}\n\nexport let DefaultsById: {[key: number]: Item} = {}\nexport let DefaultsByName: {[key: string]: Item} = {}\n\nexport function GenerateDefault() {\n    console.log(\"generating defealts\")\n    fetch(process.env.PUBLIC_URL+\"/values.lua\").then(\n        function(res) {\n            return res.text();\n        }).then(function(data) {\n        const lines = data.split(\"\\n\");\n        for (const line of lines) {\n            if(line.indexOf(\"tileslist =\") === 0) {\n                const startIndex = lines.findIndex(value => value === line);\n                ReadAllObjectLines(startIndex, lines)\n                Game.loadGrid()\n                Game.loadAllImages()\n            }\n        }\n    })\n}\n\nfunction ReadAllObjectLines(startIndex: number, lines: Array<string>) {\n    let maxID = 0;\n    for (let i = startIndex+1; i < lines.length; i++) {\n        let data = lines[i].trim();\n        if (data === \"}\") {\n            break;\n        }\n        let index = data.indexOf('=');\n        if (data.length < 2 || index < 0) {\n            continue;\n        }\n        let item = new Item()\n        data = data.substring(0, index).trim();\n        if (data.indexOf(\"object\") === 0) {\n            if (parseInt(data.substring(6), 10) > maxID) {\n                maxID = parseInt(data.substring(6), 10);\n            }\n        }\n\n        item.Name = data;\n\n        for (let j = i+1; j < lines.length; j++) {\n            let obj = lines[j].trim();\n            if (obj === \"},\") {\n                i+=j-i;\n                break;\n            }\n            index = obj.indexOf('=');\n            if (index < 0) {\n                continue;\n            }\n            let value = obj.substring(index + 1, obj.length).trim();\n            obj = obj.substring(0, index).trim().toLowerCase();\n            // console.log(obj + \" | \" + value)\n            if(value.includes(\"baba\")) {\n                value = value.replace(\"baba\", \"babu\");\n            }\n            SetItemValue(item, obj, value);\n        }\n        // if (!DefaultsByName.hasOwnProperty(item.Name)) {\n        //     DefaultsByObject.push(data);\n        //     DefaultsByName.push(item.Name);\n        //     DefaultsByID.push(item.ID);\n        // }\n        DefaultsById[item.ID] = item\n        DefaultsByName[item.Name] = item;\n    }\n    // DefaultsByObject.push(Item.EMPTY.Object);\n    // DefaultsByName.push(Item.EMPTY.Name);\n    // DefaultsByID.push(Item.EMPTY.ID);\n    // console.log(DefaultsById)\n\n    SetupObjects();\n    return maxID;\n}\n\nfunction SetItemValue(item: Item, obj:string, value:string) {\n    switch (obj) {\n        case \"name\": item.Name = value.substring(1, value.length - 2); break;\n        case \"sprite\": item.Sprite = value.substring(1, value.length - 2); break;\n        // case \"sprite_in_root\": item.SpriteInRoot = ParseBool(value); break;\n        // case \"type\": item.Type = ParseByte(value); break;\n        case \"layer\": item.zIndex = parseInt(value); break;\n        case \"colour\": item.Color = CoordinateToObject(value); break;\n        case \"active\": item.Color = CoordinateToObject(value); break;\n        case \"tiling\": item.Tiling = parseInt(value); break;\n        case \"tile\": item.ID = CoordinateToShort(value); break;\n        case \"type\": item.Type = parseInt(value); break;\n    }\n}\n\nfunction CoordinateToObject(coordinate:string): {x:number, y:number} {\n    let x = parseInt(coordinate.split(\"\")[1])\n    let y = parseInt(coordinate.split(\"\")[4])\n\n    return {x:x,y:y}\n}\n\nfunction CoordinateToShort(coordinate:string): number {\n    let startIndex = 0;\n    let endIndex = coordinate.length;\n    if (coordinate.indexOf('{') === 0) {\n        startIndex++;\n        endIndex--;\n    }\n    let index = coordinate.indexOf(',');\n    if (index < 0) {\n        return parseInt(coordinate);\n    }\n    let x = parseInt(coordinate.substring(startIndex, startIndex + (index - startIndex)));\n    let y = parseInt(coordinate.substring(index + 1, index + (endIndex - index - 1)));\n    return (y << 8) | x;\n}\n\nfunction SetupObjects() {\n    for (const itemKey of Object.keys(DefaultsByName)) {\n        const item = DefaultsByName[itemKey];\n        if(Object.keys(Node.Objects).indexOf(item.Name) === -1) {\n            Node.Objects[itemKey] = {\n                x:item.Color.x,\n                y:item.Color.y,\n                type:item.Type,\n                zIndex: item.zIndex,\n                hasWalkAni: item.Tiling === 2,\n                hasDirs: item.Tiling === 0,\n                isTileable: item.Tiling === 1,\n                spriteName:item.Sprite}\n        }\n    }\n    // console.log(Node.Objects)\n    Game.hasLoadedObjects = true;\n}\n\n//TODO: This has not been tested yet\nexport function ReadMapFromLocalFile(path:string) {\n    fetch(path).then(\n        function(res) {\n            return res.blob()\n        }).then(function(data) {\n        const reader = new FileReader();\n        reader.onload = function() {\n            return ReadMap(this.result)\n        }\n        reader.readAsBinaryString(data);\n    })\n}\n\nexport function ReadMapFromBrowseFile(e:any) {\n    const file = e.target.files[0];\n    if (!file) {\n        return;\n    }\n    const reader = new FileReader();\n    reader.onload = function() {\n        return ReadMap(this.result)\n    }\n    reader.readAsBinaryString(file);\n}\n\n\nexport function ReadMap(result:any) {\n    if(result === null || typeof result !== \"string\") return;\n    if(result.slice(0,8) !== \"ACHTUNG!\") {\n        console.error(\"Invalid map file\")\n        return\n    }\n\n    let hex = \"\";\n    for (let i = 0; i < result.length; i++) {\n        let byteStr = result.charCodeAt(i).toString(16);\n        if (byteStr.length < 2) {\n            byteStr = \"0\" + byteStr;\n        }\n        hex += \" \" + byteStr;\n    }\n    let hexArr = hex.split(\" \")\n    hexArr.shift();\n\n\n    let position = 28;\n    let layerCount = binArrayToNumb(hexArr.slice(position, position+2))\n    position += 2;\n    // version is assumed to be 261 (it is for all levels as far as I can tell)\n    for (let i = 0; i < layerCount; i++) {\n        ReadLayer(hexArr, position)\n    }\n}\n\nfunction ReadLayer(hexArr: Array<string>, position:number) {\n    const width = binArrayToNumb(hexArr.slice(position, position + 4))\n    position += 4;\n    const height = binArrayToNumb(hexArr.slice(position, position + 4))\n    position += 4;\n    // console.log(\"Width: \" + width + \" Height: \" + height)\n\n    let size = width * height;\n    position += 32;\n\n    // let data_blocks = binArrayToNumb(hexArr.slice(position, position + 1))\n    position += 1;\n\n    // MAIN contains item information\n    position += 4;\n\n    let compressed_size = binArrayToNumb(hexArr.slice(position, position + 4))\n    position += 4;\n    let compressed = hexArr.slice(position, position + compressed_size)\n    // position += compressed_size;\n\n    let compArray = new Uint8Array(compressed.map(byte => parseInt(byte, 16)))\n\n    let buffer = pako.inflate(compArray)\n    let map_buffer = []\n    for (let i = 0; i < buffer.length; i++) {\n        const value = buffer[i]\n        let tmp = value.toString(16)\n        if(tmp.length === 1) {\n            tmp = \"0\"+tmp;\n        }\n        map_buffer.push(tmp.toString())\n    }\n\n    let items: Array<Item> = [];\n    for (let j = 0, k = 0; j < size; j++, k+=2) {\n        let id = binArrayToNumb([map_buffer[k],map_buffer[k+1]])\n\n        if(id in DefaultsById) {\n            if(DefaultsById[id].Name === \"edge\") {\n                continue;\n            }\n            // console.log(\"There is a \" + DefaultsById[id].Name + \" on x: \" + j%width + \", y: \" + Math.floor(j/width))\n\n            // complicated thing to get copy of the class\n            let item = Object.assign(Object.create(Object.getPrototypeOf(DefaultsById[id])), DefaultsById[id])\n            item.x = (j%width)\n            item.y = Math.floor(j/width)\n            items.push(item)\n        } else {\n            // console.log(\"There is a EMPTY on x: \" + j%width + \", y: \" + Math.floor(j/width))\n        }\n    }\n\n\n    //DATA contains item direction\n    // position += 9\n    // compressed_size = binArrayToNumb(hexArr.slice(position, position + 4))\n    // position += 4;\n    // compressed = hexArr.slice(position, position + compressed_size)\n    // // position += compressed_size;\n    //\n    // compArray = new Uint8Array(compressed.map(byte => parseInt(byte, 16)))\n    //\n    // let dirs_buffer = pako.inflate(compArray)\n    //\n    // for (let j = 0; j < size; j++) {\n    //     let direction = dirs_buffer[j]\n    //     items[j].direction = direction;\n    // }\n\n    // console.log(items)\n\n    let grid = Game.grid;\n    grid.updateGrid(width-2,height-2)\n    for (const item of items) {\n        if(item.Name.includes(\"text\")) {\n            grid.grid[item.y-1][item.x-1].nodes.push(new Node(item.x-1,item.y-1,grid, item.Name.split(\"_\")[1], \"\", item.direction))\n        } else {\n            grid.grid[item.y-1][item.x-1].nodes.push(new Node(item.x-1,item.y-1,grid,\"\", item.Name, item.direction));\n        }\n\n    }\n    grid.rules.updateRules()\n}\n\nfunction binArrayToNumb(arr: Array<string>): number {\n    let text = \"\"\n\n    for (let i = arr.length - 1; i >= 0; i--) {\n        text += arr[i];\n    }\n\n    return parseInt(text, 16)\n}","import {Component} from \"react\";\nimport \"./MainMenu.css\"\nimport {GenerateDefault} from \"./Reader\";\n\nexport default class MainMenu extends Component {\n\n    private isInMain = true;\n    private isInSettings = false;\n    private isInCredits = false;\n\n    render() {\n        if(this.isInMain) {\n            return (\n                <div className={\"mainMenu\"}>\n                    <img className={\"mainImage\"} id={\"mainImage\"} src={process.env.PUBLIC_URL+\"/mainMenu/babu-is-you.gif\"} alt={\"babu is you\"}/>\n                    <div style={{fontFamily:\"arial\"}}>A RECREATION OF THE GAME BABA IS YOU</div>\n                    <div style={{height:\"5%\"}}/>\n                    <img id={\"start\"} src={process.env.PUBLIC_URL+\"/mainMenu/startGame.png\"} alt={\"babu is you\"} onMouseEnter={\n                        () => {\n                            // @ts-ignore\n                            document.getElementById(\"start\").src = process.env.PUBLIC_URL+\"/mainMenu/startGameSelected.png\"\n                        }\n                    } onMouseOut={\n                        () => {\n                            // @ts-ignore\n                            document.getElementById(\"start\").src = process.env.PUBLIC_URL+\"/mainMenu/startGame.png\"\n                        }\n                    } onClick={\n                        () => {\n                            this.isInMain = false;\n                            GenerateDefault();\n                            this.forceUpdate();\n                        }\n                    }/>\n                    <br/>\n                    <img id={\"settings\"} src={process.env.PUBLIC_URL+\"/mainMenu/settings.png\"} alt={\"babu is you\"} onMouseEnter={\n                        () => {\n                            // @ts-ignore\n                            document.getElementById(\"settings\").src = process.env.PUBLIC_URL+\"/mainMenu/settingsSelected.png\"\n                        }\n                    } onMouseOut={\n                        () => {\n                            // @ts-ignore\n                            document.getElementById(\"settings\").src = process.env.PUBLIC_URL+\"/mainMenu/settings.png\"\n                        }\n                    } onClick={\n                        () => {\n                            this.isInMain = false;\n                            this.isInSettings = true;\n                            this.forceUpdate();\n                        }\n                    }/>\n                    <br/>\n                    <img id={\"credits\"} src={process.env.PUBLIC_URL+\"/mainMenu/credits.png\"} alt={\"babu is you\"} onMouseEnter={\n                        () => {\n                            // @ts-ignore\n                            document.getElementById(\"credits\").src = process.env.PUBLIC_URL+\"/mainMenu/creditsSelected.png\"\n                        }\n                    } onMouseOut={\n                        () => {\n                            // @ts-ignore\n                            document.getElementById(\"credits\").src = process.env.PUBLIC_URL+\"/mainMenu/credits.png\"\n                        }\n                    } onClick={\n                        () => {\n                            this.isInMain = false;\n                            this.isInCredits = true;\n                            this.forceUpdate();\n                        }\n                    }/>\n                </div>\n            );\n        } else if(this.isInSettings) {\n            return (\n                <div className={\"mainMenu\"}>\n                    <h1>Settings</h1>\n\n                    <div className={\"settingsHolder\"}>\n                        {/*grid button on */}\n                        {localStorage.getItem(\"grid\") === \"true\" &&\n                        <img style={{width:\"auto\"}} id={\"grid\"} src={process.env.PUBLIC_URL+\"/mainMenu/gridOn.png\"} alt={\"grid\"} onMouseEnter={\n                            () => {\n                                // @ts-ignore\n                                document.getElementById(\"grid\").src = process.env.PUBLIC_URL+\"/mainMenu/gridOnSelected.png\"\n                            }\n                        } onMouseOut={\n                            () => {\n                                // @ts-ignore\n                                document.getElementById(\"grid\").src = process.env.PUBLIC_URL+\"/mainMenu/gridOn.png\"\n                            }\n                        } onClick={\n                            () => {\n                                localStorage.setItem(\"grid\", localStorage.getItem(\"grid\") === \"true\" ? \"false\" : \"true\");\n                                this.forceUpdate();\n                            }\n                        }/>\n                        }\n\n                        {/*grid button off */}\n                        {localStorage.getItem(\"grid\") === \"false\" &&\n                        <img style={{width:\"auto\"}} id={\"grid\"} src={process.env.PUBLIC_URL+\"/mainMenu/grid.png\"} alt={\"grid\"} onMouseEnter={\n                            () => {\n                                // @ts-ignore\n                                document.getElementById(\"grid\").src = process.env.PUBLIC_URL+\"/mainMenu/gridSelected.png\"\n                            }\n                        } onMouseOut={\n                            () => {\n                                // @ts-ignore\n                                document.getElementById(\"grid\").src = process.env.PUBLIC_URL+\"/mainMenu/grid.png\"\n                            }\n                        } onClick={\n                            () => {\n                                localStorage.setItem(\"grid\", localStorage.getItem(\"grid\") === \"true\" ? \"false\" : \"true\");\n                                this.forceUpdate();\n                            }\n                        }/>\n                        }\n\n\n                        <img style={{width:\"auto\", marginTop: 10}} id={\"return\"} src={process.env.PUBLIC_URL+\"/mainMenu/return.png\"} alt={\"return\"} onMouseEnter={\n                            () => {\n                                // @ts-ignore\n                                document.getElementById(\"return\").src = process.env.PUBLIC_URL+\"/mainMenu/returnSelected.png\"\n                            }\n                        } onMouseOut={\n                            () => {\n                                // @ts-ignore\n                                document.getElementById(\"return\").src = process.env.PUBLIC_URL+\"/mainMenu/return.png\"\n                            }\n                        } onClick={\n                            () => {\n                                this.isInSettings = false;\n                                this.isInMain = true;\n                                this.forceUpdate()\n                            }\n                        }/>\n                    </div>\n                </div>\n            )\n        } else if (this.isInCredits) {\n            return (\n                <div className={\"mainMenu\"}>\n                    <h1>Credits</h1>\n                    <p className={\"creditsText\"} style={{width:\"30%\", textAlign:\"center\"}}>All sprites and level design are not mine and i don't claim they are mine they are from the original creator of baba is you which this game is a recreation of</p>\n                    <img id={\"return\"} src={process.env.PUBLIC_URL+\"/mainMenu/return.png\"} alt={\"babu is you\"} onMouseEnter={\n                        () => {\n                            // @ts-ignore\n                            document.getElementById(\"return\").src = process.env.PUBLIC_URL+\"/mainMenu/returnSelected.png\"\n                        }\n                    } onMouseOut={\n                        () => {\n                            // @ts-ignore\n                            document.getElementById(\"return\").src = process.env.PUBLIC_URL+\"/mainMenu/return.png\"\n                        }\n                    } onClick={\n                        () => {\n                            this.isInCredits = false;\n                            this.isInMain = true;\n                            this.forceUpdate();\n                        }\n                    }/>\n                </div>\n            )\n        } else {\n            return(\n                <div className={\"mainMenu\"} style={{display: \"none\"}}/>\n            )\n        }\n    }\n}","import {Component} from \"react\";\nimport \"./LevelSelect.css\"\nimport {ReadMapFromLocalFile} from \"./Reader\";\n\nexport default class LevelSelect extends Component {\n\n    worldLevel = 0;\n    private worldMap!: HTMLImageElement;\n    private gridLevel!: HTMLDivElement;\n\n    render() {\n        let levels = [];\n        for (let i = 0; i < 6; i++) {\n            levels.push(\n                <div className={\"gridItem\"} onClick={() => {\n                ReadMapFromLocalFile(process.env.PUBLIC_URL+\"/custom_levels/\"+i+\"level.l\")\n                this.worldMap.style.display = \"none\";\n                this.gridLevel.style.display = \"none\"\n            }}>{\"level \" + i}</div>\n            )\n        }\n\n        return (\n            <>\n                <div className={\"worldMap\"}>\n                    <img id={\"worldMap\"} className={\"worldMap\"} src={process.env.PUBLIC_URL+\"/worldMap/worldMapMain.gif\"} alt={\"\"} ref={el => {\n                        if(el) {\n                            return this.worldMap = el\n                        }\n                    }}/>\n\n                    <div id={\"gridLevels\"} className={\"grid\"} ref={el => {\n                        if(el) {\n                            return this.gridLevel = el\n                        }\n                    }}>\n                        {levels}\n                    </div>\n                </div>\n            </>\n        )\n        // if(this.worldLevel === 0) {\n        // }\n    }\n}","import React, {Component} from \"react\";\nimport \"./Game.css\"\nimport Canvas, {Drawing} from \"./Canvas\";\nimport Grid from \"./Grid\";\nimport gitLogo from \"../GitHub-Mark-64px.png\";\nimport {GenerateDefault, ReadMapFromBrowseFile} from \"./Reader\";\nimport {Node} from \"./Node\";\nimport MainMenu from \"./MainMenu\";\nimport LevelSelect from \"./LevelSelect\";\n\nexport default class Game extends Component {\n    static get hasFullyLoaded(): boolean {\n        if(Game.debug || Game.fastLoading) {\n            return true\n        }\n        return Object.keys(Game.drawings).length === Object.keys(Node.Objects).length-1\n    }\n    static get grid(): Grid {\n        return this._grid;\n    }\n\n    static set grid(value: Grid) {\n        this._grid = value;\n        window.addEventListener(\"resize\", value.updateScreenScalings.bind(Game.grid))\n    }\n\n    static instance: Game;\n    static mainMenu: MainMenu;\n    static canvas: Canvas;\n    private static _grid:Grid;\n\n    static drawings: {[key: string]: any} = {}\n\n    private canMove: boolean = true;\n    private justUndone: boolean = false;\n\n    static debug: boolean = false;\n    static resolution: number = 50;\n    static fastLoading: boolean = false;\n\n    static hasLoadedObjects: boolean = false;\n\n    static showLevelSelect: boolean;\n    static levelSelector: LevelSelect;\n\n\n    private interval!: any;\n    private intervalW!: any;\n    private intervalD!: any;\n    private intervalS!: any;\n    private intervalA!: any;\n\n    constructor(props: any) {\n        super(props);\n        this.state = {\n            percentage: 0\n        }\n    }\n\n    componentDidMount() {\n        Game.instance = this;\n\n        window.addEventListener('keydown',this.keyDetectDown.bind(this),false);\n        window.addEventListener('keyup',this.keyDetectUp.bind(this),false);\n\n        if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\n            // do thing only in development\n        } else {\n            // If we are in production build disable debug\n            Game.debug = false;\n            Game.fastLoading = false;\n        }\n\n        if(localStorage.getItem(\"grid\") === null) {\n            localStorage.setItem(\"grid\", \"true\")\n        }\n\n        if(Game.debug) {\n            GenerateDefault()\n        }\n    }\n\n    static loadGrid() {\n        Game._grid = new Grid(Game.canvas, 10, 10, Game.resolution, Game.debug);\n        window.addEventListener(\"resize\", Game._grid.updateScreenScalings.bind(Game._grid))\n    }\n\n    movePlayers(xP:number, yP:number) {\n        if(!this.canMove) return;\n        if(Game._grid.playerPositions.length !== 0) {\n            Game._grid.undoMoves.length = Game._grid.undoStep;\n            if (Game._grid.undoMoves.length > 100) {\n                Game._grid.undoMoves.shift();\n                Game._grid.undoStep--\n                for (const undoAction of Game.grid.undoActions) {\n                    undoAction.changeOn--;\n                }\n            }\n            let doExtra = 0;\n            for (const pos of Game._grid.playerPositions) {\n                if (pos.skip) {\n                    pos.skip = false;\n                    continue\n                }\n                const findPlayerNode = Game._grid.grid[pos.y][pos.x].nodes.find(v => v.isPlayer);\n                if(findPlayerNode != null) {\n                    if(!Game._grid.moveNode(findPlayerNode, xP, yP)) doExtra++;\n                    pos.skip = false;\n                }\n            }\n            Game._grid.doMovement();\n            Game._grid.rules.updateRules()\n            let howManyRulesNotYou = 0;\n            for (const rule of Game._grid.rules.rules) {\n                if(rule.split(\" \")[2] !== \"you\") {\n                    howManyRulesNotYou++;\n                }\n            }\n\n            if(doExtra !== Game._grid.playerPositions.length || howManyRulesNotYou === Game._grid.rules.rules.length || Game._grid.didMoveThisStep) {\n                Game._grid.undoStep++\n                Game._grid.didMoveThisStep = false;\n            }\n\n            if(Game._grid.doAfterMove.length !== 0) {\n                for (const doAfterMove of Game._grid.doAfterMove) {\n                    doAfterMove.node.objectName = doAfterMove.newObjectName;\n                }\n                Game._grid.rules.resetAllNodeRules()\n            }\n            Game._grid.rules.updateRules()\n\n            this.canMove = false;\n            setTimeout(() => {\n                this.canMove = true\n            }, 100)\n        }\n    }\n\n    undoMoves() {\n        if(Game.grid.undoStep-1 < 0) return;\n        this.canMove = false\n        if(Game.grid.undoMoves.length < Game.grid.undoStep) {\n            console.error(\"Could not do undo with: \" + Game.grid.undoMoves + \" and \" + Game.grid.undoStep);\n            return\n        }\n        const undoMoves = Game.grid.undoMoves[Game.grid.undoStep-1].slice()\n        for (let i = undoMoves.length-1; i >= 0; i--) {\n            const undoMove = undoMoves[i]\n            Game.grid.moveNode(undoMove.node, undoMove.xP, undoMove.yP,false,true, true, true)\n            for (const undoAction of Game.grid.undoActions) {\n                if(undoAction.changeOn === Game.grid.undoStep) {\n                    undoAction.node.objectName = undoAction.changeTo;\n                    Game.grid.doAfterMove = []\n                    Game.grid.undoActions = Game.grid.undoActions.filter(value => value !== undoAction)\n                }\n            }\n        }\n        Game.grid.rules.updateRules()\n        Game.grid.undoStep--;\n        this.justUndone = true;\n        this.canMove = true;\n    }\n\n    //TODO: detect swipes for mobile movement\n\n    keyDetectDown(e: KeyboardEvent) {\n        if(e.repeat || !Game.hasFullyLoaded) return;\n        if(e.key === \"w\"  || e.key === \"ArrowUp\") {\n            this.movePlayers(0,-1)\n            this.intervalW = setInterval(() => this.movePlayers(0,-1), 150)\n        }\n        if(e.key === \"a\"  || e.key === \"ArrowLeft\") {\n            this.movePlayers(-1,0)\n            this.intervalA = setInterval(() => this.movePlayers(-1,0), 150)\n        }\n        if(e.key === \"s\"  || e.key === \"ArrowDown\") {\n            this.movePlayers(0,1)\n            this.intervalS = setInterval(() => this.movePlayers(0,1), 150)\n        }\n        if(e.key === \"d\"  || e.key === \"ArrowRight\") {\n            this.movePlayers(1,0)\n            this.intervalD = setInterval(() => this.movePlayers(1,0), 150)\n        }\n        if(e.key === \"z\") {\n            this.undoMoves();\n            this.interval = setInterval(() => this.undoMoves(), 200)\n        }\n    }\n\n    keyDetectUp(e: KeyboardEvent) {\n        if(e.repeat) return;\n        if(e.key === \"w\" || e.key === \"ArrowUp\") {\n            clearInterval(this.intervalW)\n        }\n        if(e.key === \"a\" || e.key === \"ArrowLeft\") {\n            clearInterval(this.intervalA)\n        }\n        if(e.key === \"s\" || e.key === \"ArrowDown\") {\n            clearInterval(this.intervalS)\n        }\n        if(e.key === \"d\" || e.key === \"ArrowRight\") {\n            clearInterval(this.intervalD)\n        }\n        if(e.key === \"z\") {\n            clearInterval(this.interval)\n        }\n    }\n\n    static loadAllImages() {\n        // load the palette of colors\n        let palette = new Image(7,5)\n        palette.src = process.env.PUBLIC_URL+\"/img/Palettes/default.png\"\n        palette.onload = () => {\n            for (const key of Object.keys(Node.Objects)) {\n                if((Game.debug || Game.fastLoading) && !tempDraw.some(value => key.includes(value))) continue;\n                const localDrawings: Array<Array<any>> = []\n\n                const hasDirections = Node.Objects[key].hasDirs\n                const hasWalking = Node.Objects[key].hasWalkAni\n\n                let amountOfDirections = 0;\n                if(hasDirections) {\n                    amountOfDirections = 24;\n                }\n                if(hasWalking) {\n                    amountOfDirections = 27;\n                }\n                if(Node.Objects[key].isTileable) {\n                    amountOfDirections = 15;\n                }\n\n                // Give drawings a proper length to assign to\n                for (let j = 0; j < amountOfDirections+1; j++) {\n                    localDrawings[j] = [];\n                    for (let i = 1; i < 4; i++) {\n                        localDrawings[j][i] = undefined;\n                    }\n                }\n\n                for (let j = 0; j < amountOfDirections+1; j++) {\n                    for (let i = 1; i < 4; i++) {\n\n                        // load image from public folder\n                        let img = new Image(24,24);\n                        if (key.includes('text')) {\n                            img.src = process.env.PUBLIC_URL+\"/img/texts/\" + Node.Objects[key].spriteName + \"_\" + j + \"_\" + i + '.png'\n                        } else {\n                            img.src = process.env.PUBLIC_URL+\"/img/objects/\" + Node.Objects[key].spriteName + \"_\" + j + \"_\" + i + '.png'\n                        }\n\n                        // get the palette image data\n                        let canvas = document.createElement('canvas');\n                        let ctx = canvas.getContext('2d');\n                        if(ctx !== null) {\n\n                        }\n\n                        // when image is loaded change it's color to correct color\n                        img.onload = () => {\n                            let canvas = document.createElement('canvas');\n                            let ctx = canvas.getContext('2d');\n                            if(ctx !== null) {\n                                ctx.imageSmoothingEnabled = false\n\n                                ctx.drawImage(palette, 100, 100, palette.width,palette.height)\n                                const paletteData = ctx.getImageData(100,100, palette.width,palette.height)\n\n                                // get image data to change\n                                ctx.drawImage(img, 0, 0, 24, 24)\n                                const imageData = ctx.getImageData(0,0,24, 24)\n                                let imgData = imageData.data;\n\n                                // get x and y for index of the palette data. \"<< 2\" does something * 4 but faster\n                                const x = Node.Objects[key].x;\n                                const y = Node.Objects[key].y;\n                                const posForColor = (y * 7 + x) << 2;\n\n                                // change the colors of the image to the palette color\n                                for (let i =0; i < imgData.length; i += 4) {\n                                    imgData[i] *= paletteData.data[posForColor]/255\n                                    imgData[i+1] *= paletteData.data[posForColor+1]/255\n                                    imgData[i+2] *= paletteData.data[posForColor+2]/255\n                                }\n\n                                // change image data to canvas for easy drawing\n                                let canvas2 = document.createElement(\"canvas\")\n                                canvas2.width = imageData.width;\n                                canvas2.height = imageData.height;\n                                let ctx2 = canvas2.getContext(\"2d\")\n                                if(ctx2 !== null) {\n                                    ctx2.putImageData(imageData, 0, 0)\n                                }\n\n                                localDrawings[j][i] = canvas2;\n                                Game.drawings[key] = localDrawings;\n                                document.getElementById(\"loading\")!.textContent = \"LOADING\\n\" + ((Object.keys(Game.drawings).length / (Object.keys(Node.Objects).length-1)) * 100).toFixed(2) + \"%\"\n                                setTimeout(() => {\n                                    if(Game.hasFullyLoaded) {\n                                        document.getElementById(\"loading\")!.style.animation = \"loadingDone 1s linear\";\n                                        document.getElementById(\"loading\")!.style.animationFillMode = \"forwards\"\n                                        Game.grid.rules.updateRules();\n                                        Game.showLevelSelect = true;\n                                        Game.instance.forceUpdate();\n                                        return;\n                                    }\n                                }, 100)\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    render() {\n\n        return(\n            <>\n                {!Game.debug &&\n                    <MainMenu ref={el => {\n                        if(el) {\n                            return Game.mainMenu = el\n                        }\n                    }}/>\n\n                }\n\n                {Game.hasFullyLoaded &&\n                    <LevelSelect ref={el => {\n                        if(el) {\n                            return Game.levelSelector = el\n                        }\n                    }}/>\n                }\n\n                <div id={\"background\"} className={\"background\"}/>\n\n                <div id={\"loading\"} className={\"loading\"}>LOADING 0%</div>\n\n                <a href=\"https://github.com/tddebart/babu-is-you\" target=\"_blank\" rel=\"noreferrer\">\n                    <img className={\"github\"} src={gitLogo} alt={\"github\"} />\n                </a>\n                <button style={{position: \"absolute\", top: \"10px\"}} onClick={() => {\n                    document.getElementById(\"worldMap\")!.style.display = \"block\";\n                    document.getElementById(\"gridLevels\")!.style.display = \"grid\";\n\n                }}>Return to level select</button>\n                <input type={\"file\"} style={{position: \"absolute\", left: 250, top: \"10px\"}} onChange={(e) => ReadMapFromBrowseFile(e)}/>\n                <label style={{position: \"absolute\", left: 250, top: 25, fontSize: 20}}>{\"Load a world (.l file)\"}</label>\n\n                <div id={\"rules-text\"} style={{position: \"absolute\", top: \"10px\", left: \"10px\", textAlign: \"left\"}}/>\n                <Canvas ref={el => {\n                    if(el) {\n                        return Game.canvas = el\n                    }\n                }}/>\n            </>\n        )\n    }\n}\n\nconst tempDraw = [\n    \"babu\",\n    \"keke\",\n    \"wall\",\n    \"is\",\n    \"you\",\n    \"rock\",\n    \"flag\",\n    \"win\",\n    \"push\",\n    \"stop\",\n    \"melt\",\n    \"hot\",\n    \"sink\",\n    \"water\",\n    \"lava\",\n    \"and\",\n    \"ice\"\n]\n\nexport class AnimatedImage extends Drawing {\n    public currentDirection: number = 0;\n    public lastDirection: number = 1;\n    public extraWalking: number = 0;\n\n    public imageName: string\n\n    public drawings: Array<Array<any>> = []\n\n    public x: number = 0;\n    public xLastFrame: number = 0;\n    public drawX: number = 0;\n    private xDir: number = 0;\n\n    public y: number = 0;\n    public yLastFrame: number = 0;\n    public drawY: number = 0;\n    private yDir: number = 0;\n\n    public offset!: { x: number; y: number };\n    public resolution: number;\n    private readonly hasWalking: boolean = false;\n    private readonly hasDirections: boolean = false;\n    private isMoving: boolean = false;\n\n    public grid: Grid;\n    public node: Node;\n\n    constructor(x:number, y:number, grid:Grid, imageName: string, node:Node) {\n        super(Game.canvas, false);\n        this.imageName = imageName;\n        this.grid = grid\n        this.node = node;\n        this.resolution = Game.resolution;\n\n        this.x = x;\n        this.xLastFrame = this.x;\n        this.drawX = x;\n\n        this.y = y;\n        this.yLastFrame = this.y;\n        this.drawY = y;\n\n        this.hasDirections = Node.Objects[this.imageName].hasDirs\n        this.hasWalking = Node.Objects[this.imageName].hasWalkAni\n    }\n\n    draw() {\n        this.drawings = Game.drawings[this.imageName];\n\n        // if there is no drawing don't try to draw the image and crash\n        if(this.drawings === undefined || this.drawings[this.currentDirection][this.currentFrame] === undefined) return;\n\n        // Reset the direction\n        this.currentDirection = 0;\n\n        // set the currentDirection for objects that have more than 1 direction like the skull\n        if(this.hasDirections) {\n            this.currentDirection = this.lastDirection === 0? 8 : this.lastDirection === 1 ? 0 : this.lastDirection === 2 ? 24 : this.lastDirection === 3 ? 16 : 0;\n        }\n        // set the currentDirection for objects that have walking animation\n        if(this.hasWalking) {\n            this.currentDirection = this.lastDirection === 0? 8 : this.lastDirection === 1 ? 0 : this.lastDirection === 2 ? 24 : this.lastDirection === 3 ? 16 : 0;\n            if(this.x !== this.xLastFrame || this.y !== this.yLastFrame) {\n                if(this.extraWalking !== 3) {\n                    this.extraWalking += 1;\n                } else {\n                    this.extraWalking = 0;\n                }\n            }\n            this.currentDirection += this.extraWalking;\n        }\n        if(this.x !== this.xLastFrame || this.y !== this.yLastFrame) {\n            this.xDir = this.x - this.xLastFrame\n            this.yDir = this.y - this.yLastFrame\n            this.drawX = this.x-this.xDir\n            this.drawY = this.y-this.yDir;\n        }\n\n        //#region tile sides\n\n        // Tile system\n        if(Node.Objects[this.imageName].isTileable && !this.isMoving) {\n            let hasLeft = false;\n            let hasRight = false;\n            let hasTop = false;\n            let hasBottom = false;\n\n            //TODO: when pushing two or more walls for one frame they are not connected\n            if(!(this.x+1 > this.grid.width-1) && this.grid.grid[this.y][this.x+1].nodes.some(value => value.objectName === this.imageName)) {\n                // const nextNodes = this.grid.grid[this.y][this.x+1].nodes.filter(value => value.objectName === this.imageName)\n                // let shouldDo = true;\n                // for (const nextNode of nextNodes) {\n                //     if(nextNode.isMoving) {\n                //         shouldDo = false;\n                //     }\n                // }\n                // if(shouldDo) {\n                hasRight = true;\n                // }\n            }\n            if(!(this.x-1 < 0) && this.grid.grid[this.y][this.x-1].nodes.some(value => value.objectName === this.imageName)) {\n                // const nextNodes = this.grid.grid[this.y][this.x-1].nodes.filter(value => value.objectName === this.imageName)\n                // let shouldDo = true;\n                // for (const nextNode of nextNodes) {\n                //     if(nextNode.isMoving) {\n                //         shouldDo = false;\n                //     }\n                // }\n                // if(shouldDo) {\n                hasLeft = true;\n                // }\n            }\n            if(!(this.y+1 > this.grid.height-1) && this.grid.grid[this.y+1][this.x].nodes.some(value => value.objectName === this.imageName)) {\n                // const nextNodes = this.grid.grid[this.y+1][this.x].nodes.filter(value => value.objectName === this.imageName)\n                // let shouldDo = true;\n                // for (const nextNode of nextNodes) {\n                //     if(nextNode.isMoving) {\n                //         shouldDo = false;\n                //     }\n                // }\n                // if(shouldDo) {\n                hasBottom = true;\n                // }\n            }\n            if(!(this.y-1 < 0) && this.grid.grid[this.y-1][this.x].nodes.some(value => value.objectName === this.imageName)) {\n                // const nextNodes = this.grid.grid[this.y-1][this.x].nodes.filter(value => value.objectName === this.imageName)\n                // let shouldDo = true;\n                // for (const nextNode of nextNodes) {\n                //     if(nextNode.isMoving) {\n                //         shouldDo = false;\n                //     }\n                // }\n                // if(shouldDo) {\n                hasTop = true;\n                // }\n            }\n\n            // Right\n            if(!hasLeft && hasRight && !hasTop && !hasBottom) {\n                this.currentDirection += 1;\n            }\n            //Top\n            else if(!hasLeft && !hasRight && hasTop && !hasBottom) {\n                this.currentDirection += 2;\n            }\n            // Top and right\n            else if(!hasLeft && hasRight && hasTop && !hasBottom) {\n                this.currentDirection += 3;\n            }\n            // Left side\n            else if(hasLeft && !hasRight && !hasTop && !hasBottom) {\n                this.currentDirection += 4;\n            }\n            // Left and right\n            else if(hasLeft && hasRight && !hasTop && !hasBottom) {\n                this.currentDirection += 5;\n            }\n            // Left and top\n            else if(hasLeft && !hasRight && hasTop && !hasBottom) {\n                this.currentDirection += 6;\n            }\n            // Left, top and right\n            else if(hasLeft && hasRight && hasTop && !hasBottom) {\n                this.currentDirection += 7;\n            }\n            // Bottom\n            else if(!hasLeft && !hasRight && !hasTop && hasBottom) {\n                this.currentDirection += 8;\n            }\n            // Bottom and right\n            else if(!hasLeft && hasRight && !hasTop && hasBottom) {\n                this.currentDirection += 9;\n            }\n            // Top and bottom\n            else if(!hasLeft && !hasRight && hasTop && hasBottom) {\n                this.currentDirection += 10;\n            }\n            // Top, bottom and right\n            else if(!hasLeft && hasRight && hasTop && hasBottom) {\n                this.currentDirection += 11;\n            }\n            // Bottom and left\n            else if(hasLeft && !hasRight && !hasTop && hasBottom) {\n                this.currentDirection += 12;\n            }\n            // Left, bottom and right\n            else if(hasLeft && hasRight && !hasTop && hasBottom) {\n                this.currentDirection += 13;\n            }\n            // Top, bottom and left\n            else if(hasLeft && !hasRight && hasTop && hasBottom) {\n                this.currentDirection += 14;\n            }\n            // All sides\n            else if(hasLeft && hasRight && hasTop && hasBottom) {\n                this.currentDirection += 15;\n            }\n        }\n\n        //#endregion\n\n        this.ctx.imageSmoothingEnabled = false\n        // if there is no drawing don't try to draw the image and crash\n        if(this.drawings[this.currentDirection][this.currentFrame] === undefined) return;\n\n        this.ctx.drawImage(this.drawings[this.currentDirection][this.currentFrame], this.drawX*this.resolution+this.offset.x,this.drawY*this.resolution+this.offset.y, this.resolution, this.resolution);\n\n        if(parseFloat(this.drawX.toFixed(1)) !== this.x || parseFloat(this.drawY.toFixed(1)) !== this.y) {\n            this.drawX+= 0.2*this.xDir\n            this.drawY+= 0.2*this.yDir;\n            this.isMoving = true;\n            this.node.isMoving = true;\n        } else {\n            this.isMoving = false;\n            this.node.isMoving = false;\n        }\n\n        this.xLastFrame = this.x;\n        this.yLastFrame = this.y;\n    }\n}","import React from 'react';\nimport './App.css';\nimport Game from \"./Game/Game\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n          <Game/>\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}